/**
* @license bigwig.js
* Copyright (c) 2015 Florin Chelaru
* License: MIT
*
* Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
* documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
* Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
* WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
* COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
* OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){'use strict';var n=this;function aa(){}
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ca(a){return"function"==ba(a)}function da(a,b,c){return a.call.apply(a.bind,arguments)}function ea(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?da:ea;return p.apply(null,arguments)}function fa(a,b){var c=a.split("."),d=n;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}
function q(a,b){function c(){}c.prototype=b.prototype;a.Ta=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Na=function(a,c,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}};function t(a,b){u.Exception.apply(this,arguments);this.name="BigwigException"}q(t,u.Exception);function v(a,b){this.b=a|0;this.a=b|0}var ga={},w={};function ha(a){if(-128<=a&&128>a){var b=ga[a];if(b)return b}b=new v(a|0,0>a?-1:0);-128<=a&&128>a&&(ga[a]=b);return b}function x(a){isNaN(a)||!isFinite(a)?a=y():a<=-ia?a=A():a+1>=ia?(w[ja]||(w[ja]=new v(-1,2147483647)),a=w[ja]):a=0>a?B(x(-a)):new v(a%C|0,a/C|0);return a}var C=4294967296,ia=C*C/2;function y(){w[ka]||(w[ka]=ha(0));return w[ka]}function la(){w[ma]||(w[ma]=ha(1));return w[ma]}function na(){w[oa]||(w[oa]=ha(-1));return w[oa]}
function A(){w[pa]||(w[pa]=new v(0,-2147483648));return w[pa]}v.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(D(this))return"0";if(0>this.a){if(E(this,A())){var b=x(a),c=F(this,b),b=G(H(c,b),this);return c.toString(a)+b.b.toString(a)}return"-"+B(this).toString(a)}for(var c=x(Math.pow(a,6)),b=this,d="";;){var e=F(b,c),f=(G(b,H(e,c)).b>>>0).toString(a),b=e;if(D(b))return f+d;for(;6>f.length;)f="0"+f;d=""+f+d}};function qa(a){return 0<=a.b?a.b:C+a.b}
function D(a){return 0==a.a&&0==a.b}function E(a,b){return a.a==b.a&&a.b==b.b}function ra(a){w[sa]||(w[sa]=ha(16777216));return 0>ta(a,w[sa])}function ta(a,b){if(E(a,b))return 0;var c=0>a.a,d=0>b.a;return c&&!d?-1:!c&&d?1:0>G(a,b).a?-1:1}function B(a){return E(a,A())?A():(new v(~a.b,~a.a)).add(la())}
v.prototype.add=function(a){var b=this.a>>>16,c=this.a&65535,d=this.b>>>16,e=a.a>>>16,f=a.a&65535,g=a.b>>>16,h;h=0+((this.b&65535)+(a.b&65535));a=0+(h>>>16);a+=d+g;d=0+(a>>>16);d+=c+f;c=0+(d>>>16);c=c+(b+e)&65535;return new v((a&65535)<<16|h&65535,c<<16|d&65535)};function G(a,b){return a.add(B(b))}
function H(a,b){if(D(a)||D(b))return y();if(E(a,A()))return 1==(b.b&1)?A():y();if(E(b,A()))return 1==(a.b&1)?A():y();if(0>a.a)return 0>b.a?H(B(a),B(b)):B(H(B(a),b));if(0>b.a)return B(H(a,B(b)));if(ra(a)&&ra(b))return x((a.a*C+qa(a))*(b.a*C+qa(b)));var c=a.a>>>16,d=a.a&65535,e=a.b>>>16,f=a.b&65535,g=b.a>>>16,h=b.a&65535,l=b.b>>>16,m=b.b&65535,k,r,z,Pa;Pa=0+f*m;z=0+(Pa>>>16);z+=e*m;r=0+(z>>>16);z=(z&65535)+f*l;r+=z>>>16;z&=65535;r+=d*m;k=0+(r>>>16);r=(r&65535)+e*l;k+=r>>>16;r&=65535;r+=f*h;k+=r>>>16;
r&=65535;k=k+(c*m+d*l+e*h+f*g)&65535;return new v(z<<16|Pa&65535,k<<16|r)}
function F(a,b){if(D(b))throw Error("division by zero");if(D(a))return y();if(E(a,A())){if(E(b,la())||E(b,na()))return A();if(E(b,A()))return la();var c;c=1;if(0==c)c=a;else{var d=a.a;c=32>c?new v(a.b>>>c|d<<32-c,d>>c):new v(d>>c-32,0<=d?0:-1)}c=F(c,b);d=1;if(0!=d){var e=c.b;c=32>d?new v(e<<d,c.a<<d|e>>>32-d):new v(0,e<<d-32)}if(E(c,y()))return 0>b.a?la():na();d=G(a,H(b,c));return c.add(F(d,b))}if(E(b,A()))return y();if(0>a.a)return 0>b.a?F(B(a),B(b)):B(F(B(a),b));if(0>b.a)return B(F(a,B(b)));e=y();
for(d=a;0<=ta(d,b);){c=Math.max(1,Math.floor((d.a*C+qa(d))/(b.a*C+qa(b))));for(var f=Math.ceil(Math.log(c)/Math.LN2),f=48>=f?1:Math.pow(2,f-48),g=x(c),h=H(g,b);0>h.a||0<ta(h,d);)c-=f,g=x(c),h=H(g,b);D(g)&&(g=la());e=e.add(g);d=G(d,h)}return e}var ja=1,pa=2,ka=3,ma=4,oa=5,sa=6;function I(a){var b=this;u.each(a,function(a,d){b[a]=d})}I.prototype.toString=function(){return JSON.stringify(this,function(a,b){return b instanceof v?0==b.a?qa(b):b.toString():b})};function J(a,b,c,d){c=new DataView(c);return K(a,b,c,d)}
function K(a,b,c,d){var e=!d,f={},g=0,h;u.each(b,function(a,b){var d;switch(b){case 8:d=c.getUint32(g,!e);var r=c.getUint32(g+4,!e);d=e?new v(r,d):new v(d,r);break;case 4:d=c.getUint32(g,!e);break;case 2:d=c.getUint16(g,!e);break;case 1:d=c.getUint8(g);break;case -8:d=c.getFloat64(g,!e);break;case -4:d=c.getFloat32(g,!e);break;case 0:for(h=[];g<c.byteLength&&(0==h.length||0!=h[h.length-1]);++g)h.push(c.getUint8(g));d=String.fromCharCode.apply(null,h);break;default:h=new Uint8Array(c.buffer,c.byteOffset+
g,b),d=h.indexOf(0),0<=d&&(h=h.subarray(0,d)),d=String.fromCharCode.apply(null,h)}g+=Math.abs(b);f[a]=d});return u.reflection.applyConstructor(a,[f])}function L(a){var b=0;a=a.Fields;if(!a)throw new t("Cannot compute size of type (fields not defined)");u.each(a,function(a,d){b+=Math.abs(d)});return b};function M(){I.apply(this,arguments)}q(M,I);function N(){I.apply(this,arguments)}q(N,I);Object.defineProperties(N.prototype,{Ca:{get:function(){return 2291137574==this.Y}},v:{get:function(){return!this.Ca}}});N.Fields={Y:4,version:2,H:2,ua:8,Ra:8,da:8,Qa:2,Oa:2,Ma:8,Ua:8,Va:4,M:8};function ua(a){if(Error.captureStackTrace)Error.captureStackTrace(this,ua);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}q(ua,Error);ua.prototype.name="CustomError";function va(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function wa(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};function xa(a,b,c){this.g=c;this.c=a;this.j=b;this.b=0;this.a=null}xa.prototype.get=function(){var a;0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c();return a};function ya(a,b){a.j(b);a.b<a.g&&(a.b++,b.next=a.a,a.a=b)};var za=String.prototype.repeat?function(a,b){return a.repeat(b)}:function(a,b){return Array(b+1).join(a)};var Aa;a:{var Ba=n.navigator;if(Ba){var Ca=Ba.userAgent;if(Ca){Aa=Ca;break a}}Aa=""};var Da=Array.prototype,Ea=Da.some?function(a,b,c){return Da.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e="string"==typeof a?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function Fa(a){n.setTimeout(function(){throw a;},0)}var Ga;
function Ha(){var a=n.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&-1==Aa.indexOf("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=p(function(a){if(("*"==d||a.origin==
d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&-1==Aa.indexOf("Trident")&&-1==Aa.indexOf("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.ra;c.ra=null;a()}};return function(a){d.next={ra:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=
document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){n.setTimeout(a,0)}};function Ia(){this.b=this.a=null}var Ka=new xa(function(){return new Ja},function(a){a.reset()},100);Ia.prototype.add=function(a,b){var c=Ka.get();c.a=a;c.b=b;c.next=null;this.b?this.b.next=c:this.a=c;this.b=c};function La(){var a=Ma,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function Ja(){this.next=this.b=this.a=null}Ja.prototype.reset=function(){this.next=this.b=this.a=null};function Na(a,b){Oa||Qa();Ra||(Oa(),Ra=!0);Ma.add(a,b)}var Oa;function Qa(){if(n.Promise&&n.Promise.resolve){var a=n.Promise.resolve(void 0);Oa=function(){a.then(Sa)}}else Oa=function(){var a=Sa;!ca(n.setImmediate)||n.Window&&n.Window.prototype&&n.Window.prototype.setImmediate==n.setImmediate?(Ga||(Ga=Ha()),Ga(a)):n.setImmediate(a)}}var Ra=!1,Ma=new Ia;function Sa(){for(var a=null;a=La();){try{a.a.call(a.b)}catch(b){Fa(b)}ya(Ka,a)}Ra=!1};function O(a,b){this.a=Ta;this.L=void 0;this.c=this.b=this.g=null;this.j=this.F=!1;if(a!=aa)try{var c=this;a.call(b,function(a){Ua(c,Va,a)},function(a){Ua(c,P,a)})}catch(d){Ua(this,P,d)}}var Ta=0,Va=2,P=3;function Wa(){this.next=this.c=this.b=this.g=this.a=null;this.j=!1}Wa.prototype.reset=function(){this.c=this.b=this.g=this.a=null;this.j=!1};var Xa=new xa(function(){return new Wa},function(a){a.reset()},100);function Ya(a,b,c){var d=Xa.get();d.g=a;d.b=b;d.c=c;return d}
O.prototype.then=function(a,b,c){return Za(this,ca(a)?a:null,ca(b)?b:null,c)};va(O);function $a(a,b){a.b||a.a!=Va&&a.a!=P||ab(a);a.c?a.c.next=b:a.b=b;a.c=b}function Za(a,b,c,d){var e=Ya(null,null,null);e.a=new O(function(a,g){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(m){g(m)}}:a;e.b=c?function(b){try{var e=c.call(d,b);a(e)}catch(m){g(m)}}:g});e.a.g=a;$a(a,e);return e.a}O.prototype.Z=function(a){this.a=Ta;Ua(this,Va,a)};O.prototype.ja=function(a){this.a=Ta;Ua(this,P,a)};
function Ua(a,b,c){if(a.a==Ta){a==c&&(b=P,c=new TypeError("Promise cannot resolve to itself"));a.a=1;var d;a:{var e=c,f=a.Z,g=a.ja;if(e instanceof O)$a(e,Ya(f||aa,g||null,a)),d=!0;else if(wa(e))e.then(f,g,a),d=!0;else{var h=typeof e;if("object"==h&&null!=e||"function"==h)try{var l=e.then;if(ca(l)){bb(e,l,f,g,a);d=!0;break a}}catch(m){g.call(a,m);d=!0;break a}d=!1}}d||(a.L=c,a.a=b,a.g=null,ab(a),b!=P||cb(a,c))}}
function bb(a,b,c,d,e){function f(a){h||(h=!0,d.call(e,a))}function g(a){h||(h=!0,c.call(e,a))}var h=!1;try{b.call(a,g,f)}catch(l){f(l)}}function ab(a){a.F||(a.F=!0,Na(a.X,a))}function db(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.c=null);return b}
O.prototype.X=function(){for(var a=null;a=db(this);){var b=this.a,c=this.L;if(b==P&&a.b&&!a.j)for(var d=void 0,d=this;d&&d.j;d=d.g)d.j=!1;if(a.a)a.a.g=null,eb(a,b,c);else try{a.j?a.g.call(a.c):eb(a,b,c)}catch(e){fb.call(null,e)}ya(Xa,a)}this.F=!1};function eb(a,b,c){b==Va?a.g.call(a.c,c):a.b&&a.b.call(a.c,c)}function cb(a,b){a.j=!0;Na(function(){a.j&&fb.call(null,b)})}var fb=Fa;/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function Q(a,b){this.g=[];this.va=b||null;this.b=this.P=!1;this.c=void 0;this.Z=this.ja=this.F=!1;this.j=0;this.L=null;this.Ka=0}Q.prototype.X=function(a,b){this.F=!1;gb(this,a,b)};function gb(a,b,c){a.P=!0;a.c=c;a.b=!b;hb(a)}function ib(a){if(a.P){if(!a.Z)throw new jb;a.Z=!1}}Q.prototype.a=function(a){ib(this);gb(this,!0,a)};Q.prototype.wa=function(a){ib(this);gb(this,!1,a)};function kb(a,b,c,d){a.g.push([b,c,d]);a.P&&hb(a)}
Q.prototype.then=function(a,b,c){var d,e,f=new O(function(a,b){d=a;e=b});kb(this,d,function(a){e(a)});return f.then(a,b,c)};va(Q);function R(a,b){kb(a,b.a,b.wa,b)}function lb(a){return Ea(a.g,function(a){return ca(a[1])})}
function hb(a){if(a.j&&a.P&&lb(a)){var b=a.j,c=mb[b];c&&(n.clearTimeout(c.W),delete mb[b]);a.j=0}a.L&&(a.L.Ka--,delete a.L);for(var b=a.c,d=c=!1;a.g.length&&!a.F;){var e=a.g.shift(),f=e[0],g=e[1],e=e[2];if(f=a.b?g:f)try{var h=f.call(e||a.va,b);void 0!==h&&(a.b=a.b&&(h==b||h instanceof Error),a.c=b=h);if(wa(b)||"function"===typeof n.Promise&&b instanceof n.Promise)d=!0,a.F=!0}catch(l){b=l,a.b=!0,lb(a)||(c=!0)}}a.c=b;d&&(h=p(a.X,a,!0),d=p(a.X,a,!1),b instanceof Q?(kb(b,h,d),b.ja=!0):b.then(h,d));c&&
(b=new nb(b),mb[b.W]=b,a.j=b.W)}function jb(){ua.call(this)}q(jb,ua);jb.prototype.message="Deferred has already fired";jb.prototype.name="AlreadyCalledError";function nb(a){this.W=n.setTimeout(p(this.b,this),0);this.a=a}nb.prototype.b=function(){delete mb[this.W];throw this.a;};var mb={};function ob(a){this.b=a}function pb(a){this.children=a?a.children||null:null}function qb(a,b){if(a.b){var c=function(a){b.call(null,a)||a.children&&a.children.length&&a.children.forEach(c)};c(a.b)}};function S(a){ob.apply(this,arguments);this.U=this.a=null}q(S,ob);function rb(a){pb.apply(this,arguments);this.key=a.key;this.chrId=a.I;this.chrSize=a.sa}q(rb,pb);S.prototype.V=function(a){if("number"==typeof a)return sb(this),this.a[a];tb(this);return this.U[a]};Object.defineProperties(S.prototype,{Ha:{get:function(){tb(this);return u.map(this.U,function(a){return a})}}});function tb(a){if(!a.U){var b={};qb(a,function(a){a.children||(b[a.key]=a)});a.U=b}}
function sb(a){if(!a.a){var b={};qb(a,function(a){a.children||(b[a.chrId]=a)});a.a=b}};function ub(){I.apply(this,arguments)}q(ub,I);ub.Fields={Ba:8,ha:-8,ga:-8,$:-8,aa:-8};function T(){M.apply(this,arguments)}q(T,M);T.Fields={ca:4,ta:4,value:-4};function vb(){I.apply(this,arguments)}q(vb,I);function wb(a,b,c){return K(vb,{key:b,Da:8},a,c)};function xb(){I.apply(this,arguments)}q(xb,I);xb.Fields={Ia:4,M:4,l:8,Ea:8};function yb(){I.apply(this,arguments)}q(yb,I);yb.Fields={B:1,M:1,count:2};function zb(){I.apply(this,arguments)}q(zb,I);zb.Fields={G:4,w:4,D:4,A:4,l:8};function Ab(a,b){return K(zb,zb.Fields,a,b)};function U(){M.apply(this,arguments)}q(U,M);U.Fields={value:-4};function Bb(a,b){var c=Array.prototype.slice.call(arguments),d=c.shift();if("undefined"==typeof d)throw Error("[goog.string.format] Template required");return d.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,d,h,l,m,k,r){if("%"==m)return"%";var z=c.shift();if("undefined"==typeof z)throw Error("[goog.string.format] Not enough arguments");arguments[0]=z;return V[m].apply(null,arguments)})}
var V={s:function(a,b,c){return isNaN(c)||""==c||a.length>=c?a:a=-1<b.indexOf("-",0)?a+za(" ",c-a.length):za(" ",c-a.length)+a},f:function(a,b,c,d,e){d=a.toString();isNaN(e)||""==e||(d=parseFloat(a).toFixed(e));var f;f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"";0<=a&&(d=f+d);if(isNaN(c)||d.length>=c)return d;d=isNaN(e)?Math.abs(a).toString():Math.abs(a).toFixed(e);a=c-d.length-f.length;return d=0<=b.indexOf("-",0)?f+d+za(" ",a):f+za(0<=b.indexOf("0",0)?"0":" ",a)+d},d:function(a,b,c,d,
e,f,g,h){return V.f(parseInt(a,10),b,c,d,0,f,g,h)}};V.i=V.d;V.u=V.d;function Cb(){I.apply(this,arguments)}q(Cb,I);Cb.Fields={G:4,w:4,D:4,A:4,l:8,J:8};function Db(a,b){return K(Cb,Cb.Fields,a,b)};function Eb(){I.apply(this,arguments)}q(Eb,I);Eb.Fields={Y:4,qa:4,ea:8,G:4,w:4,D:4,A:4,Pa:8,Sa:4,M:4};function Fb(){I.apply(this,arguments)}q(Fb,I);Fb.Fields={Y:4,qa:4,fa:4,Wa:4,ea:8,M:8};function Gb(){I.apply(this,arguments)}q(Gb,I);Gb.Fields={B:1,M:1,count:2};function Hb(){I.apply(this,arguments)}q(Hb,I);Hb.Fields={I:4,start:4,end:4,ka:4,ha:-4,ga:-4,$:-4,aa:-4};function W(){M.apply(this,arguments)}q(W,M);W.Fields={ca:4,value:-4};function Ib(){I.apply(this,arguments)}q(Ib,I);Ib.Fields={I:4,start:4,end:4,Ga:4,Fa:4,type:1,M:1,ea:2};function Jb(){I.apply(this,arguments)}q(Jb,I);function Kb(a,b,c){return K(Jb,{key:b,I:4,sa:4},a,c)};function Lb(a,b){this.b=a;this.a=b||null}var Mb=L(N),Nb=L(xb),Ob=L(ub),Pb=L(Fb),Qb=L(yb),Rb=L(Eb),Sb=L(Gb),Tb=L(zb),Ub=L(Cb),Vb=L(Ib),Wb=L(Hb),Xb={1:[T,function(a,b){return K(T,T.Fields,a,b)},function(a,b){return J(T,T.Fields,a,b)}],2:[W,function(a,b){return K(W,W.Fields,a,b)},function(a,b){return J(W,W.Fields,a,b)}],3:[U,function(a,b){return K(U,U.Fields,a,b)},function(a,b){return J(U,U.Fields,a,b)}]};
Lb.prototype.get=function(a,b,c){function d(){var a=new XMLHttpRequest;a.open("GET",l,!0);e.a||a.setRequestHeader("Range",Bb("bytes=%s-%s",g,h));a.responseType="arraybuffer";a.onload=c;a.onreadystatechange=function(){4===a.readyState&&200!==a.status&&206!=a.status&&(--f,f?(console.log("Failed: Range "+Bb("bytes=%s-%s",g,h)+"; retrying..."),d()):console.error("Failed: Range "+Bb("bytes=%s-%s",g,h)))};a.send()}var e=this,f=10,g=a instanceof v?a.toString():a,h=b instanceof v?G(b,ha(1)).toString():b-
1,l=this.a?Bb("%s?r=%s-%s&q=%s",this.a,g,h,this.b):this.b;d()};function Yb(a){var b=new Q;a.get(0,Mb,function(a){var d=a.target.response;a=(new DataView(d)).getUint32(0);d=J(N,N.Fields,d,2291137574!=a);d.Y=a;b.a(d)});return b}function Zb(a,b,c){if(c>=b.H||0>c)throw new t("Bigwig: invalid zoom index");var d=new Q;a.get(Mb+c*Nb,Mb+(c+1)*Nb,function(a){a=J(xb,xb.Fields,a.target.response,b.v);d.a(a)});return d}
function $b(a,b){for(var c=Array(b.H),d=b.H,e=new Q,f=0;f<b.H;++f)(function(f){Zb(a,b,f).then(function(a){c[f]=a;--d;d||e.a(c)})})(f);return e}function ac(a,b){var c=new Q,d=Mb+Nb*b.H;a.get(d,d+Ob,function(a){a=J(ub,ub.Fields,a.target.response,b.v);c.a(a)});return c}function bc(a,b){var c=new Q,d=b.ua;a.get(d,d.add(x(Pb)),function(a){a=J(Fb,Fb.Fields,a.target.response,b.v);c.a(a)});return c}
function cc(a,b,c,d){var e=new Q,f=c.fa+8,g=d.add(x(Qb+c.qa*f));a.get(d,g,function(a){a=a.target.response;var d;d=new DataView(a,0,Qb);d=K(yb,yb.Fields,d,b.v);for(var g=[],k=0;k<d.count;++k)g.push(d.B?Kb(new DataView(a,Qb+k*f,f),c.fa,b.v):wb(new DataView(a,Qb+k*f,f),c.fa,b.v));e.a({node:d,items:g})});return e}
function dc(a,b){var c=null,d=new Q;bc(a,b).then(function(e){function f(c){var d=[];c.items.forEach(function(g){var k=new rb({key:g.key});c.node.B?(k.chrId=g.I,k.chrSize=g.sa):cc(a,b,e,g.Da).then(function(a){k.children=f(a)});d.push(k)});return d}var g=b.ua.add(x(Pb));cc(a,b,e,g).then(function(a){a=f(a);c=new rb({children:a});d.a(new S(c))})});return d}function ec(a,b,c){var d=new Q;c=c||b.da;a.get(c,c.add(x(Rb)),function(a){a=J(Eb,Eb.Fields,a.target.response,b.v);d.a(a)});return d}
function fc(a,b,c){var d=new Q;a.get(c,c.add(x(Sb)),function(a){a=J(Gb,Gb.Fields,a.target.response,b.v);d.a(a)});return d}function gc(a,b,c){var d=new Q;fc(a,b,c).then(function(e){var f=c.add(x(Sb)),g=e.B?Ub:Tb,h=f.add(x(e.count*g));a.get(f,h,function(a){a=a.target.response;for(var c=[],f=0;f<e.count;++f)c.push(e.B?Db(new DataView(a,f*g,g),b.v):Ab(new DataView(a,f*g,g),b.v));d.a({node:e,items:c})})});return d}
function hc(a,b,c){var d=new Q,e=c.l;c=c.l.add(c.J);a.get(e,c,function(a){a=new Uint8Array(a.target.response,0);a=(new Zlib.Inflate(a)).decompress();var c;c=new DataView(a.buffer,0,Vb);c=K(Ib,Ib.Fields,c,b.v);for(var e=[],l=Xb[c.type][1],m=L(Xb[c.type][0]),k=0;k<c.ea;++k)e[k]=l(new DataView(a.buffer,Vb+m*k,m),b.v);d.a({Ja:c,ia:e})});return d}
function ic(a,b,c){var d=new Q,e=c.l;c=c.l.add(c.J);a.get(e,c,function(a){a=new Uint8Array(a.target.response,0);a=(new Zlib.Inflate(a)).decompress();for(var c=a.byteLength/Wb,e=Array(c),l=0;l<c;++l){var m=l,k;k=new DataView(a.buffer,l*Wb,Wb);k=K(Hb,Hb.Fields,k,b.v);e[m]=k}d.a({ia:e})});return d}
function jc(a,b,c,d,e,f){var g=new Q;gc(a,b,f).then(function(f){if(f.node.B){var l=[];f.items.forEach(function(a){l.push(new kc({B:!0,N:a.G,w:a.w,K:a.D,A:a.A,l:a.l,J:a.J}))});g.a(l)}else{var m=[],k=f.items.length;f.items.forEach(function(f){var h=new kc({B:!1,N:f.G,w:f.w,K:f.D,A:f.A,l:f.l});m.push(h);f.G>c&&f.D<c?--k:f.D==c&&f.A<=d||f.G==c&&f.w>=e?--k:jc(a,b,c,d,e,f.l).then(function(a){h.children=a;--k;k||g.a(m)})});k||g.a(m)}});return g}
function lc(a,b,c,d,e,f){var g=new Q;f=f||b.da;ec(a,b,f).then(function(h){var l=f.add(x(Rb)),m=new kc({B:!1,N:h.G,K:h.D,w:h.w,A:h.A,l:l});jc(a,b,c,d,e,l).then(function(a){m.children=a;g.a(new mc(m))})});return g};function mc(a){ob.apply(this,arguments)}q(mc,ob);function nc(a,b,c,d){var e=[];qb(a,function(a){if(a.K<b||a.N>b||a.N==b&&a.w>=d||a.K==b&&a.A<=c)return!0;if(a.children&&a.children.length)return!1;e.push(a)});return e}function kc(a){pb.apply(this,a);this.B=a.B;this.N=a.N;this.K=a.K;this.w=a.w;this.A=a.A;this.l=a.l;this.J=a.J;this.O=a.O}q(kc,pb);function X(){}Object.defineProperties(X.prototype,{chrName:{get:function(){throw new t("Abstract method not implemented");}},chr:{get:function(){throw new t("Abstract method not implemented");}},start:{get:function(){throw new t("Abstract method not implemented");}},end:{get:function(){throw new t("Abstract method not implemented");}}});var Y={ya:0,xa:1,za:2,na:3,La:4,ma:5,la:6};X.prototype.value=function(){throw new t("Abstract method not implemented");};X.prototype.toString=function(){return JSON.stringify(this.toJSON())};
X.prototype.toJSON=function(){return{chr:this.chrName,start:this.start,end:this.end,value:this.value}};function Z(a,b,c){this.pa=a;this.h=b;this.m=c||null}q(Z,X);Object.defineProperties(Z.prototype,{chrName:{get:function(){return this.m?this.m.V(this.chr).key:this.chr}},chr:{get:function(){return this.h.I}},start:{get:function(){return this.h.start}},end:{get:function(){return this.h.end}}});
Z.prototype.value=function(a){switch(a){case Y.ya:return this.h.ha;case Y.xa:return this.h.ga;case Y.za:return this.h.$;case Y.na:return this.h.aa;case Y.ma:return Math.sqrt(this.h.aa/this.h.ka);case Y.la:return this.h.ka;default:return this.h.$/this.h.ka}};function oc(a,b,c,d,e){this.pa=a;this.ba=b;this.h=c;this.Aa=d;this.m=e||null}q(oc,X);Object.defineProperties(oc.prototype,{chrName:{get:function(){return this.m?this.m.V(this.chr).key:this.chr}},chr:{get:function(){return this.ba.I}},start:{get:function(){return void 0!=this.h.ca?this.h.ca:this.pa.w+this.ba.Ga*this.Aa}},end:{get:function(){return void 0!=this.h.ta?this.h.ta:this.start+this.ba.Fa}}});
oc.prototype.value=function(a){switch(a){case Y.na:return this.h.value*this.h.value;case Y.ma:return Math.abs(this.h.value);case Y.la:return 1;default:return this.h.value}};function pc(a,b){this.a=new Lb(a,b);this.g=this.c=this.j=this.m=this.C=this.o=null;this.oa=!1;this.T=new Q}
pc.prototype.b=function(a,b,c,d){var e=this,f=new Q;if(!this.initialized.P)return this.initialized.then(function(){R(e.b(a,b,c,d),f)}),f;var g=this.m.V(a).chrId;if(d&&void 0==d.level&&(d.S&&0<d.S||d.R&&0<d.R)){d.R||(d.R=d.S);d.S||(d.S=d.R);var h=this.c.map(function(a){return a.Ia}),l=-1;c-b>d.R&&++l;if(0==l)for(;l<this.c.length-1&&!((c-b)/h[l]<=d.S);++l);d.level=l}var m=d&&0<=d.level,h=m?this.g[d.level]:this.j;if(!h)return lc(this.a,this.o,g,b,c,m?this.c[d.level].Ea:this.o.da).then(function(a){m?
e.g[d.level]=a:e.j=a;R(e.b(g,b,c,d),f)}),f;var h=nc(h,g,b,c),k=0;h.forEach(function(a){a.B||(++k,jc(e.a,e.o,g,b,c,a.l).then(function(h){a.children=h;--k;k||R(e.b(g,b,c,d),f)}))});if(k)return f;k=0;h.forEach(function(a){a.O||(++k,m?ic(e.a,e.o,a).then(function(h){a.O=h.ia.map(function(b){return new Z(a,b,e.m)});--k;k||R(e.b(g,b,c,d),f)}):hc(e.a,e.o,a).then(function(h){a.O=h.ia.map(function(b,c){return new oc(a,h.Ja,b,c,e.m)});--k;k||R(e.b(g,b,c,d),f)}))});if(k)return f;h=h.map(function(a){return a.O.filter(function(a){return a.chr==
g&&a.start<c&&a.end>b})}).reduce(function(a,b){return a.concat(b)});f.a(h);return f};Object.defineProperties(pc.prototype,{initialized:{get:function(){if(this.oa)return this.T;this.oa=!0;qc(this);return this.T}},summary:{get:function(){return this.C?{basesCovered:this.C.Ba.toString(),min:this.C.ha,max:this.C.ga,sumData:this.C.$,sumSquares:this.C.aa}:null}},chromosomes:{get:function(){return this.m?this.m.Ha:null}},zoomLevels:{get:function(){return this.o?this.o.H:null}}});
function qc(a){var b=new Q;if(!a.o)return Yb(a.a).then(function(c){a.o=c;R(qc(a),b)}),b;if(!a.C)return ac(a.a,a.o).then(function(c){a.C=c;R(qc(a),b)}),b;if(!a.m)return dc(a.a,a.o).then(function(c){a.m=c;R(qc(a),b)}),b;if(!a.c)return $b(a.a,a.o).then(function(c){a.c=c;R(qc(a),b)}),b;a.g||(a.g=Array(a.o.H));a.T.a(a);return a.T};fa("bigwig.BigwigFile",pc);pc.prototype.query=pc.prototype.b;fa("bigwig.ChrTree",S);S.prototype.getLeaf=S.prototype.V;fa("bigwig.ChrTree.Node",rb);oc.prototype.value=oc.prototype.value;Z.prototype.value=Z.prototype.value;fa("bigwig.DataRecord",X);X.prototype.value=X.prototype.value;fa("bigwig.DataRecord.Aggregate",Y);}).call(this); //@ sourceMappingURL=bigwig.min.js.map
