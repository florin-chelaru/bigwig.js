/**
* @license bigwig.js
* Copyright (c) 2015 Florin Chelaru
* License: MIT
*
* Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
* documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
* Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
* WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
* COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
* OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){'use strict';var aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var g;c.length&&(g=c.shift());)c.length||void 0===b?d[g]?d=d[g]:d=d[g]={}:d[g]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Ca=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.wa=function(a,c,f){for(var e=Array(arguments.length-2),h=2;h<arguments.length;h++)e[h-2]=arguments[h];return b.prototype[c].apply(a,e)}};function r(a,b){u.Exception.apply(this,arguments);this.name="BigwigException"}q(r,u.Exception);function t(a,b){this.b=a|0;this.a=b|0}var ba={},v={};function w(a){if(-128<=a&&128>a){var b=ba[a];if(b)return b}b=new t(a|0,0>a?-1:0);-128<=a&&128>a&&(ba[a]=b);return b}function x(a){isNaN(a)||!isFinite(a)?a=z():a<=-ca?a=A():a+1>=ca?(v[da]||(v[da]=new t(-1,2147483647)),a=v[da]):a=0>a?B(x(-a)):new t(a%C|0,a/C|0);return a}
function ea(a,b){if(0==a.length)throw Error("number format error: empty string");var c=b||10;if(2>c||36<c)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return B(ea(a.substring(1),c));if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character: '+a);for(var d=x(Math.pow(c,8)),g=z(),f=0;f<a.length;f+=8){var e=Math.min(8,a.length-f),h=parseInt(a.substring(f,f+e),c);8>e?(e=x(Math.pow(c,e)),g=D(E(g,e),x(h))):(g=E(g,d),g=D(g,x(h)))}return g}var C=4294967296,ca=C*C/2;
function z(){v[fa]||(v[fa]=w(0));return v[fa]}function F(){v[ga]||(v[ga]=w(1));return v[ga]}function ha(){v[ia]||(v[ia]=w(-1));return v[ia]}function A(){v[ja]||(v[ja]=new t(0,-2147483648));return v[ja]}function G(a){return a.a*C+(0<=a.b?a.b:C+a.b)}
t.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(H(this))return"0";if(0>this.a){if(I(this,A())){var b=x(a),c=J(this,b),b=K(E(c,b),this);return c.toString(a)+b.b.toString(a)}return"-"+B(this).toString(a)}for(var c=x(Math.pow(a,6)),b=this,d="";;){var g=J(b,c),f=(K(b,E(g,c)).b>>>0).toString(a),b=g;if(H(b))return f+d;for(;6>f.length;)f="0"+f;d=""+f+d}};function H(a){return 0==a.a&&0==a.b}function I(a,b){return a.a==b.a&&a.b==b.b}
function ka(a){v[la]||(v[la]=w(16777216));return 0>ma(a,v[la])}function ma(a,b){if(I(a,b))return 0;var c=0>a.a,d=0>b.a;return c&&!d?-1:!c&&d?1:0>K(a,b).a?-1:1}function B(a){return I(a,A())?A():D(new t(~a.b,~a.a),F())}function D(a,b){var c=a.a>>>16,d=a.a&65535,g=a.b>>>16,f=b.a>>>16,e=b.a&65535,h=b.b>>>16,l,k;k=0+((a.b&65535)+(b.b&65535));l=0+(k>>>16);l+=g+h;g=0+(l>>>16);g+=d+e;d=0+(g>>>16);d=d+(c+f)&65535;return new t((l&65535)<<16|k&65535,d<<16|g&65535)}function K(a,b){return D(a,B(b))}
function E(a,b){if(H(a)||H(b))return z();if(I(a,A()))return 1==(b.b&1)?A():z();if(I(b,A()))return 1==(a.b&1)?A():z();if(0>a.a)return 0>b.a?E(B(a),B(b)):B(E(B(a),b));if(0>b.a)return B(E(a,B(b)));if(ka(a)&&ka(b))return x(G(a)*G(b));var c=a.a>>>16,d=a.a&65535,g=a.b>>>16,f=a.b&65535,e=b.a>>>16,h=b.a&65535,l=b.b>>>16,k=b.b&65535,p,m,y,Ba;Ba=0+f*k;y=0+(Ba>>>16);y+=g*k;m=0+(y>>>16);y=(y&65535)+f*l;m+=y>>>16;y&=65535;m+=d*k;p=0+(m>>>16);m=(m&65535)+g*l;p+=m>>>16;m&=65535;m+=f*h;p+=m>>>16;m&=65535;p=p+(c*
k+d*l+g*h+f*e)&65535;return new t(y<<16|Ba&65535,p<<16|m)}
function J(a,b){if(H(b))throw Error("division by zero");if(H(a))return z();if(I(a,A())){if(I(b,F())||I(b,ha()))return A();if(I(b,A()))return F();var c;c=1;if(0==c)c=a;else{var d=a.a;c=32>c?new t(a.b>>>c|d<<32-c,d>>c):new t(d>>c-32,0<=d?0:-1)}c=J(c,b);d=1;if(0!=d){var g=c.b;c=32>d?new t(g<<d,c.a<<d|g>>>32-d):new t(0,g<<d-32)}if(I(c,z()))return 0>b.a?F():ha();d=K(a,E(b,c));return D(c,J(d,b))}if(I(b,A()))return z();if(0>a.a)return 0>b.a?J(B(a),B(b)):B(J(B(a),b));if(0>b.a)return B(J(a,B(b)));g=z();for(d=
a;0<=ma(d,b);){c=Math.max(1,Math.floor(G(d)/G(b)));for(var f=Math.ceil(Math.log(c)/Math.LN2),f=48>=f?1:Math.pow(2,f-48),e=x(c),h=E(e,b);0>h.a||0<ma(h,d);)c-=f,e=x(c),h=E(e,b);H(e)&&(e=F());g=D(g,e);d=K(d,h)}return g}var da=1,ja=2,fa=3,ga=4,ia=5,la=6;function L(a){var b=this;u.each(a,function(a,d){b[a]=d})}L.prototype.toString=function(){return JSON.stringify(this,function(a,b){return b instanceof t?0==b.a?0<=b.b?b.b:C+b.b:b.toString():b})};function M(a,b,c,d){c=new DataView(c);return N(a,b,c,d)}
function N(a,b,c,d){var g=!d,f={},e=0,h;u.each(b,function(a,b){var d;switch(b){case 8:d=c.getUint32(e,!g);var m=c.getUint32(e+4,!g);d=g?new t(m,d):new t(d,m);break;case 4:d=c.getUint32(e,!g);break;case 2:d=c.getUint16(e,!g);break;case 1:d=c.getUint8(e);break;case -8:d=c.getFloat64(e,!g);break;case -4:d=c.getFloat32(e,!g);break;case 0:for(h=[];e<c.byteLength&&(0==h.length||0!=h[h.length-1]);++e)h.push(c.getUint8(e));d=String.fromCharCode.apply(null,h);break;default:h=new Uint8Array(c.buffer,c.byteOffset+
e,b),d=h.indexOf(0),0<=d&&(h=h.subarray(0,d)),d=String.fromCharCode.apply(null,h)}e+=Math.abs(b);f[a]=d});return u.reflection.applyConstructor(a,[f])}function O(a){var b=0;a=a.Fields;if(!a)throw new r("Cannot compute size of type (fields not defined)");u.each(a,function(a,d){b+=Math.abs(d)});return b};function na(){L.apply(this,arguments)}q(na,L);na.Fields={v:1,I:1,count:2};function oa(){L.apply(this,arguments)}q(oa,L);oa.Fields={S:4,ha:4,Z:8,D:4,m:4,B:4,o:4,ya:8,Ba:4,I:4};var pa=String.prototype.repeat?function(a,b){return a.repeat(b)}:function(a,b){return Array(b+1).join(a)};function qa(a,b){var c=Array.prototype.slice.call(arguments),d=c.shift();if("undefined"==typeof d)throw Error("[goog.string.format] Template required");return d.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,d,h,l,k,p,m){if("%"==k)return"%";var y=c.shift();if("undefined"==typeof y)throw Error("[goog.string.format] Not enough arguments");arguments[0]=y;return P[k].apply(null,arguments)})}
var P={s:function(a,b,c){return isNaN(c)||""==c||a.length>=c?a:a=-1<b.indexOf("-",0)?a+pa(" ",c-a.length):pa(" ",c-a.length)+a},f:function(a,b,c,d,g){d=a.toString();isNaN(g)||""==g||(d=parseFloat(a).toFixed(g));var f;f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"";0<=a&&(d=f+d);if(isNaN(c)||d.length>=c)return d;d=isNaN(g)?Math.abs(a).toString():Math.abs(a).toFixed(g);a=c-d.length-f.length;return d=0<=b.indexOf("-",0)?f+d+pa(" ",a):f+pa(0<=b.indexOf("0",0)?"0":" ",a)+d},d:function(a,b,c,d,
g,f,e,h){return P.f(parseInt(a,10),b,c,d,0,f,e,h)}};P.i=P.d;P.u=P.d;function ra(){L.apply(this,arguments)}q(ra,L);function sa(a,b,c){return N(ra,{key:b,oa:8},a,c)};function Q(){L.apply(this,arguments)}q(Q,L);function R(){Q.apply(this,arguments)}q(R,Q);R.Fields={X:4,ja:4,value:-4};function S(){Q.apply(this,arguments)}q(S,Q);S.Fields={X:4,value:-4};function ta(){L.apply(this,arguments)}q(ta,L);ta.Fields={v:1,I:1,count:2};function ua(){L.apply(this,arguments)}q(ua,L);ua.Fields={ma:8,ca:-8,ba:-8,T:-8,U:-8};function va(){L.apply(this,arguments)}q(va,L);va.Fields={ta:4,I:4,g:8,pa:8};function T(){Q.apply(this,arguments)}q(T,Q);T.Fields={value:-4};function U(){L.apply(this,arguments)}q(U,L);Object.defineProperties(U.prototype,{na:{get:function(){return 2291137574==this.S}},l:{get:function(){return!this.na}}});U.Fields={S:4,version:2,K:2,ka:8,Aa:8,Y:8,za:2,xa:2,va:8,Da:8,Ea:4,I:8};function wa(){L.apply(this,arguments)}q(wa,L);wa.Fields={S:4,ha:4,$:4,Fa:4,Z:8,I:8};function xa(){L.apply(this,arguments)}q(xa,L);xa.Fields={F:4,start:4,end:4,ra:4,qa:4,type:1,I:1,Z:2};function ya(){L.apply(this,arguments)}q(ya,L);ya.Fields={D:4,m:4,B:4,o:4,g:8};function za(a,b){return N(ya,ya.Fields,a,b)};function Aa(){L.apply(this,arguments)}q(Aa,L);Aa.Fields={D:4,m:4,B:4,o:4,g:8,G:8};function Ca(a,b){return N(Aa,Aa.Fields,a,b)};function Da(){L.apply(this,arguments)}q(Da,L);Da.Fields={F:4,start:4,end:4,ea:4,ca:-4,ba:-4,T:-4,U:-4};function Ea(){L.apply(this,arguments)}q(Ea,L);function Fa(a,b,c){return N(Ea,{key:b,F:4,ia:4},a,c)};function Ga(a){this.b=a}function Ha(a){this.children=a?a.children||null:null}function Ia(a,b){if(a.b){var c=function(a){b.call(null,a)||a.children&&a.children.length&&a.children.forEach(c)};c(a.b)}};function V(a){Ga.apply(this,arguments);this.O=this.a=null}q(V,Ga);function Ja(a){Ha.apply(this,arguments);this.key=a.key;this.chrId=a.F;this.chrSize=a.ia}q(Ja,Ha);V.prototype.P=function(a){if("number"==typeof a)return Ka(this),this.a[a];La(this);return this.O[a]};Object.defineProperties(V.prototype,{sa:{get:function(){La(this);return u.map(this.O,function(a){return a})}}});function La(a){if(!a.O){var b={};Ia(a,function(a){a.children||(b[a.key]=a)});a.O=b}}
function Ka(a){if(!a.a){var b={};Ia(a,function(a){a.children||(b[a.chrId]=a)});a.a=b}};function Ma(a,b,c){this.M=a;this.w=b||null;this.b=null;var d=this;this.aa=new Promise(function(a){void 0!=d.b?a(d.b):d.get(0,1,function(b,c){var h=c.getResponseHeader("Content-Range");d.b=ea(h.substr(h.indexOf("/")+1));a(d.b)})});this.R=c&&0<c?1024*c:Na;this.a=0===c?this.get:this.N;this.C={}}
var Na=524288,Oa=O(U),Pa=O(va),Qa=O(ua),Ra=O(wa),Sa=O(ta),Ta=O(oa),Ua=O(na),Va=O(ya),Wa=O(Aa),Xa=O(xa),Ya=O(Da),Za={1:[R,function(a,b){return N(R,R.Fields,a,b)},function(a,b){return M(R,R.Fields,a,b)}],2:[S,function(a,b){return N(S,S.Fields,a,b)},function(a,b){return M(S,S.Fields,a,b)}],3:[T,function(a,b){return N(T,T.Fields,a,b)},function(a,b){return M(T,T.Fields,a,b)}]};
Ma.prototype.get=function(a,b,c){function d(){var a=new XMLHttpRequest;a.open("GET",l,!0);g.w||a.setRequestHeader("Range",qa("bytes=%s-%s",e,h));a.responseType="arraybuffer";a.onload=function(a){c(a.target.response,a.target)};a.onreadystatechange=function(){4===a.readyState&&200!==a.status&&206!=a.status&&(--f,f?(console.log("Failed: Range "+qa("bytes=%s-%s",e,h)+"; retrying..."),d()):console.error("Failed: Range "+qa("bytes=%s-%s",e,h)))};a.send()}var g=this,f=10,e=a instanceof t?a.toString():a,
h=b instanceof t?K(b,w(1)).toString():b-1,l=this.w?qa("%s?r=%s-%s&q=%s",this.w,e,h,this.M):this.M;d()};
Ma.prototype.N=function(a,b,c){var d=this;if(void 0==d.b)d.aa.then(function(){d.N(a,b,c)});else{var g=a instanceof t?a:x(a),f=b instanceof t?b:x(b),e=x(this.R),h=J(g,e),l=J(f,e),k=E(h,e),p=D(k,e);I(h,l)?(e=h.toString(),h=this.C[e],h||(h=new Promise(function(a){0<ma(p,d.b)&&(p=d.b);d.get(k,p,function(b){a(b)})}),this.C[e]=h),h.then(function(a){var b=G(K(g,k)),d=G(K(f,k));c(a.slice(b,d))})):d.get(a,b,c)}};
function $a(a){return new Promise(function(b){a.a(0,Oa,function(a){var d=(new DataView(a)).getUint32(0);a=M(U,U.Fields,a,2291137574!=d);a.S=d;b(a)})})}function ab(a,b,c){if(c>=b.K||0>c)throw new r("Bigwig: invalid zoom index");return new Promise(function(d){a.a(Oa+c*Pa,Oa+(c+1)*Pa,function(a){a=M(va,va.Fields,a,b.l);d(a)})})}
function bb(a,b){return new Promise(function(c){var d=Array(b.K);u.async.for(b.K,function(c){return new Promise(function(f){ab(a,b,c).then(function(a){d[c]=a;f()})})}).then(function(){c(d)})})}function cb(a,b){return new Promise(function(c){var d=Oa+Pa*b.K;a.a(d,d+Qa,function(a){a=M(ua,ua.Fields,a,b.l);c(a)})})}function db(a,b){return new Promise(function(c){var d=b.ka;a.a(d,D(d,x(Ra)),function(a){a=M(wa,wa.Fields,a,b.l);c(a)})})}
function eb(a,b,c,d){return new Promise(function(g){var f=c.$+8,e=D(d,x(Sa+c.ha*f));a.a(d,e,function(a){var d;d=new DataView(a,0,Sa);d=N(ta,ta.Fields,d,b.l);for(var e=[],p=0;p<d.count;++p)e.push(d.v?Fa(new DataView(a,Sa+p*f,f),c.$,b.l):sa(new DataView(a,Sa+p*f,f),c.$,b.l));g({node:d,items:e})})})}
function fb(a,b){return new Promise(function(c){var d=null;db(a,b).then(function(g){function f(d){var c=[];d.items.forEach(function(e){var p=new Ja({key:e.key});d.node.v?(p.chrId=e.F,p.chrSize=e.ia):eb(a,b,g,e.oa).then(function(a){p.children=f(a)});c.push(p)});return c}var e=D(b.ka,x(Ra));eb(a,b,g,e).then(function(a){a=f(a);d=new Ja({children:a});c(new V(d))})})})}function gb(a,b,c){return new Promise(function(d){c=c||b.Y;a.a(c,D(c,x(Ta)),function(a){a=M(oa,oa.Fields,a,b.l);d(a)})})}
function hb(a,b,c){return new Promise(function(d){a.a(c,D(c,x(Ua)),function(a){a=M(na,na.Fields,a,b.l);d(a)})})}function ib(a,b,c){return new Promise(function(d){hb(a,b,c).then(function(g){var f=D(c,x(Ua)),e=g.v?Wa:Va,h=D(f,x(g.count*e));a.a(f,h,function(a){for(var c=[],f=0;f<g.count;++f)c.push(g.v?Ca(new DataView(a,f*e,e),b.l):za(new DataView(a,f*e,e),b.l));d({node:g,items:c})})})})}
function jb(a,b,c){return new Promise(function(d){a.a(c.g,D(c.g,c.G),function(a){a=new Uint8Array(a,0);a=(new Zlib.Inflate(a)).decompress();var c;c=new DataView(a.buffer,0,Xa);c=N(xa,xa.Fields,c,b.l);for(var e=[],h=Za[c.type][1],l=O(Za[c.type][0]),k=0;k<c.Z;++k)e[k]=h(new DataView(a.buffer,Xa+l*k,l),b.l);d({ua:c,da:e})})})}
function kb(a,b,c){return new Promise(function(d){a.a(c.g,D(c.g,c.G),function(a){a=new Uint8Array(a,0);a=(new Zlib.Inflate(a)).decompress();for(var c=a.byteLength/Ya,e=Array(c),h=0;h<c;++h){var l=h,k;k=new DataView(a.buffer,h*Ya,Ya);k=N(Da,Da.Fields,k,b.l);e[l]=k}d({da:e})})})}
function lb(a,b,c,d,g,f){return new Promise(function(e){ib(a,b,f).then(function(f){if(f.node.v){var l=[];f.items.forEach(function(a){l.push(new mb({v:!0,J:a.D,m:a.m,H:a.B,o:a.o,g:a.g,G:a.G}))});e(l)}else{var k=[];u.async.each(f.items,function(f){return new Promise(function(e){var h=new mb({v:!1,J:f.D,m:f.m,H:f.B,o:f.o,g:f.g});k.push(h);f.D>c&&f.B<c?e():f.B==c&&f.o<=d||f.D==c&&f.m>=g?e():lb(a,b,c,d,g,f.g).then(function(a){h.children=a;e()})})}).then(function(){e(k)})}})})}
function nb(a,b,c,d,g,f){return new Promise(function(e){f=f||b.Y;gb(a,b,f).then(function(h){var l=D(f,x(Ta)),k=new mb({v:!1,J:h.D,H:h.B,m:h.m,o:h.o,g:l});lb(a,b,c,d,g,l).then(function(a){k.children=a;e(new ob(k))})})})};function ob(a){Ga.apply(this,arguments)}q(ob,Ga);function pb(a,b,c,d){var g=[];Ia(a,function(a){if(a.H<b||a.J>b||a.J==b&&a.m>=d||a.H==b&&a.o<=c)return!0;if(a.children&&a.children.length)return!1;g.push(a)});return g}function mb(a){Ha.apply(this,a);this.v=a.v;this.J=a.J;this.H=a.H;this.m=a.m;this.o=a.o;this.g=a.g;this.G=a.G;this.L=a.L}q(mb,Ha);function W(){}Object.defineProperties(W.prototype,{chrName:{get:function(){throw new r("Abstract method not implemented");}},chr:{get:function(){throw new r("Abstract method not implemented");}},start:{get:function(){throw new r("Abstract method not implemented");}},end:{get:function(){throw new r("Abstract method not implemented");}}});var X={MIN:0,MAX:1,SUM:2,SUMSQ:3,AVG:4,NORM:5,CNT:6};W.prototype.value=function(){throw new r("Abstract method not implemented");};W.prototype.toString=function(){return JSON.stringify(this.toJSON())};
W.prototype.toJSON=function(){return{chr:this.chrName,start:this.start,end:this.end,value:this.value}};function Y(a,b,c){this.ga=a;this.c=b;this.h=c||null}q(Y,W);Object.defineProperties(Y.prototype,{chrName:{get:function(){return this.h?this.h.P(this.chr).key:this.chr}},chr:{get:function(){return this.c.F}},start:{get:function(){return this.c.start}},end:{get:function(){return this.c.end}}});
Y.prototype.value=function(a){switch(a){case X.MIN:return this.c.ca;case X.MAX:return this.c.ba;case X.SUM:return this.c.T;case X.SUMSQ:return this.c.U;case X.NORM:return Math.sqrt(this.c.U/this.c.ea);case X.CNT:return this.c.ea;default:return this.c.T/this.c.ea}};function Z(a,b,c,d,g){this.ga=a;this.W=b;this.c=c;this.la=d;this.h=g||null}q(Z,W);Object.defineProperties(Z.prototype,{chrName:{get:function(){return this.h?this.h.P(this.chr).key:this.chr}},chr:{get:function(){return this.W.F}},start:{get:function(){return void 0!=this.c.X?this.c.X:this.ga.m+this.W.ra*this.la}},end:{get:function(){return void 0!=this.c.ja?this.c.ja:this.start+this.W.qa}}});
Z.prototype.value=function(a){switch(a){case X.SUMSQ:return this.c.value*this.c.value;case X.NORM:return Math.abs(this.c.value);case X.CNT:return 1;default:return this.c.value}};function qb(a,b,c){this.a=new Ma(a,b,c);this.C=this.w=this.M=this.h=this.A=this.j=null;this.fa=!1;this.aa=this.R=null;this.N=!1;var d=this;this.V=new Promise(function(a,b){d.R=a;d.aa=b})}
qb.prototype.b=function(a,b,c,d){var g=this,f,e=new Promise(function(a){f=a});if(!this.N)return this.initialized.then(function(){g.b(a,b,c,d).then(f)}),e;var h=this.h.P(a).chrId;if(d&&void 0==d.level&&(d.maxItems&&0<d.maxItems||d.maxBases&&0<d.maxBases)){d.maxBases||(d.maxBases=d.maxItems);d.maxItems||(d.maxItems=d.maxBases);var l=this.w.map(function(a){return a.ta}),k=-1;c-b>d.maxBases&&++k;if(0==k)for(;k<this.w.length-1&&!((c-b)/l[k]<=d.maxItems);++k);d.level=k}var p=d&&0<=d.level,l=p?this.C[d.level]:
this.M;if(!l)return nb(this.a,this.j,h,b,c,p?this.w[d.level].pa:this.j.Y).then(function(a){p?g.C[d.level]=a:g.M=a;g.b(h,b,c,d).then(f)}),e;var l=pb(l,h,b,c),m=0;l.forEach(function(a){a.v||(++m,lb(g.a,g.j,h,b,c,a.g).then(function(e){a.children=e;--m;m||g.b(h,b,c,d).then(f)}))});if(m)return e;m=0;l.forEach(function(a){a.L||(++m,p?kb(g.a,g.j,a).then(function(e){a.L=e.da.map(function(b){return new Y(a,b,g.h)});--m;m||g.b(h,b,c,d).then(f)}):jb(g.a,g.j,a).then(function(e){a.L=e.da.map(function(b,c){return new Z(a,
e.ua,b,c,g.h)});--m;m||g.b(h,b,c,d).then(f)}))});if(m)return e;l=l.map(function(a){return a.L.filter(function(a){return a.chr==h&&a.start<c&&a.end>b})}).reduce(function(a,b){return a.concat(b)});f(l);return e};
Object.defineProperties(qb.prototype,{initialized:{get:function(){if(this.fa)return this.V;this.fa=!0;rb(this);return this.V}},summary:{get:function(){return this.A?{basesCovered:this.A.ma.toString(),min:this.A.ca,max:this.A.ba,sumData:this.A.T,sumSquares:this.A.U}:null}},chromosomes:{get:function(){return this.h?this.h.sa:null}},zoomLevels:{get:function(){return this.j?this.j.K:null}}});
function rb(a){var b,c=new Promise(function(a){b=a});if(!a.j)return $a(a.a).then(function(c){a.j=c;rb(a).then(b)}),c;if(!a.A)return cb(a.a,a.j).then(function(c){a.A=c;rb(a).then(b)}),c;if(!a.h)return fb(a.a,a.j).then(function(c){a.h=c;rb(a).then(b)}),c;if(!a.w)return bb(a.a,a.j).then(function(c){a.w=c;rb(a).then(b)}),c;a.C||(a.C=Array(a.j.K));a.N=!0;a.R(a);return a.V};n("bigwig.BigwigFile",qb);qb.prototype.query=qb.prototype.b;n("bigwig.ChrTree",V);V.prototype.getLeaf=V.prototype.P;n("bigwig.ChrTree.Node",Ja);Z.prototype.value=Z.prototype.value;Y.prototype.value=Y.prototype.value;n("bigwig.DataRecord",W);W.prototype.value=W.prototype.value;n("bigwig.DataRecord.Aggregate",X);}).call(this); //@ sourceMappingURL=bigwig.min.js.map
