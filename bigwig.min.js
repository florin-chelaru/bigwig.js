/**
* @license bigwig.js
* Copyright (c) 2015 Florin Chelaru
* License: MIT
*
* Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
* documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
* Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
* WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
* COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
* OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){'use strict';var aa=this;function l(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var g;c.length&&(g=c.shift());)c.length||void 0===b?d[g]?d=d[g]:d=d[g]={}:d[g]=b}function m(a,b){function c(){}c.prototype=b.prototype;a.Ca=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.wa=function(a,c,f){for(var e=Array(arguments.length-2),h=2;h<arguments.length;h++)e[h-2]=arguments[h];return b.prototype[c].apply(a,e)}};function ba(a){this.b=a}function ca(a){this.children=a?a.children||null:null}function da(a,b){if(a.b){var c=function(a){b.call(null,a)||a.children&&a.children.length&&a.children.forEach(c)};c(a.b)}};function q(a){ba.apply(this,arguments);this.O=this.a=null}m(q,ba);function ea(a){ca.apply(this,arguments);this.key=a.key;this.chrId=a.F;this.chrSize=a.ia}m(ea,ca);q.prototype.P=function(a){if("number"==typeof a)return fa(this),this.a[a];ga(this);return this.O[a]};Object.defineProperties(q.prototype,{la:{get:function(){ga(this);return u.map(this.O,function(a){return a})}}});function ga(a){if(!a.O){var b={};da(a,function(a){a.children||(b[a.key]=a)});a.O=b}}
function fa(a){if(!a.a){var b={};da(a,function(a){a.children||(b[a.chrId]=a)});a.a=b}};function t(a,b){this.b=a|0;this.a=b|0}var ha={},v={};function w(a){if(-128<=a&&128>a){var b=ha[a];if(b)return b}b=new t(a|0,0>a?-1:0);-128<=a&&128>a&&(ha[a]=b);return b}function x(a){isNaN(a)||!isFinite(a)?a=z():a<=-ia?a=A():a+1>=ia?(v[ja]||(v[ja]=new t(-1,2147483647)),a=v[ja]):a=0>a?B(x(-a)):new t(a%C|0,a/C|0);return a}
function ka(a,b){if(0==a.length)throw Error("number format error: empty string");var c=b||10;if(2>c||36<c)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return B(ka(a.substring(1),c));if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character: '+a);for(var d=x(Math.pow(c,8)),g=z(),f=0;f<a.length;f+=8){var e=Math.min(8,a.length-f),h=parseInt(a.substring(f,f+e),c);8>e?(e=x(Math.pow(c,e)),g=D(E(g,e),x(h))):(g=E(g,d),g=D(g,x(h)))}return g}var C=4294967296,ia=C*C/2;
function z(){v[la]||(v[la]=w(0));return v[la]}function F(){v[ma]||(v[ma]=w(1));return v[ma]}function na(){v[oa]||(v[oa]=w(-1));return v[oa]}function A(){v[pa]||(v[pa]=new t(0,-2147483648));return v[pa]}function G(a){return a.a*C+(0<=a.b?a.b:C+a.b)}
t.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(H(this))return"0";if(0>this.a){if(I(this,A())){var b=x(a),c=J(this,b),b=K(E(c,b),this);return c.toString(a)+b.b.toString(a)}return"-"+B(this).toString(a)}for(var c=x(Math.pow(a,6)),b=this,d="";;){var g=J(b,c),f=(K(b,E(g,c)).b>>>0).toString(a),b=g;if(H(b))return f+d;for(;6>f.length;)f="0"+f;d=""+f+d}};function H(a){return 0==a.a&&0==a.b}function I(a,b){return a.a==b.a&&a.b==b.b}
function qa(a){v[ra]||(v[ra]=w(16777216));return 0>sa(a,v[ra])}function sa(a,b){if(I(a,b))return 0;var c=0>a.a,d=0>b.a;return c&&!d?-1:!c&&d?1:0>K(a,b).a?-1:1}function B(a){return I(a,A())?A():D(new t(~a.b,~a.a),F())}function D(a,b){var c=a.a>>>16,d=a.a&65535,g=a.b>>>16,f=b.a>>>16,e=b.a&65535,h=b.b>>>16,n,k;k=0+((a.b&65535)+(b.b&65535));n=0+(k>>>16);n+=g+h;g=0+(n>>>16);g+=d+e;d=0+(g>>>16);d=d+(c+f)&65535;return new t((n&65535)<<16|k&65535,d<<16|g&65535)}function K(a,b){return D(a,B(b))}
function E(a,b){if(H(a)||H(b))return z();if(I(a,A()))return 1==(b.b&1)?A():z();if(I(b,A()))return 1==(a.b&1)?A():z();if(0>a.a)return 0>b.a?E(B(a),B(b)):B(E(B(a),b));if(0>b.a)return B(E(a,B(b)));if(qa(a)&&qa(b))return x(G(a)*G(b));var c=a.a>>>16,d=a.a&65535,g=a.b>>>16,f=a.b&65535,e=b.a>>>16,h=b.a&65535,n=b.b>>>16,k=b.b&65535,p,r,y,Ca;Ca=0+f*k;y=0+(Ca>>>16);y+=g*k;r=0+(y>>>16);y=(y&65535)+f*n;r+=y>>>16;y&=65535;r+=d*k;p=0+(r>>>16);r=(r&65535)+g*n;p+=r>>>16;r&=65535;r+=f*h;p+=r>>>16;r&=65535;p=p+(c*
k+d*n+g*h+f*e)&65535;return new t(y<<16|Ca&65535,p<<16|r)}
function J(a,b){if(H(b))throw Error("division by zero");if(H(a))return z();if(I(a,A())){if(I(b,F())||I(b,na()))return A();if(I(b,A()))return F();var c;c=1;if(0==c)c=a;else{var d=a.a;c=32>c?new t(a.b>>>c|d<<32-c,d>>c):new t(d>>c-32,0<=d?0:-1)}c=J(c,b);d=1;if(0!=d){var g=c.b;c=32>d?new t(g<<d,c.a<<d|g>>>32-d):new t(0,g<<d-32)}if(I(c,z()))return 0>b.a?F():na();d=K(a,E(b,c));return D(c,J(d,b))}if(I(b,A()))return z();if(0>a.a)return 0>b.a?J(B(a),B(b)):B(J(B(a),b));if(0>b.a)return B(J(a,B(b)));g=z();for(d=
a;0<=sa(d,b);){c=Math.max(1,Math.floor(G(d)/G(b)));for(var f=Math.ceil(Math.log(c)/Math.LN2),f=48>=f?1:Math.pow(2,f-48),e=x(c),h=E(e,b);0>h.a||0<sa(h,d);)c-=f,e=x(c),h=E(e,b);H(e)&&(e=F());g=D(g,e);d=K(d,h)}return g}var ja=1,pa=2,la=3,ma=4,oa=5,ra=6;function L(a,b){u.Exception.apply(this,arguments);this.name="BigwigException"}m(L,u.Exception);function M(a){var b=this;u.each(a,function(a,d){b[a]=d})}M.prototype.toString=function(){return JSON.stringify(this,function(a,b){return b instanceof t?0==b.a?0<=b.b?b.b:C+b.b:b.toString():b})};function N(a,b,c,d){c=new DataView(c);return O(a,b,c,d)}
function O(a,b,c,d){var g=!d,f={},e=0,h;u.each(b,function(a,b){var d;switch(b){case 8:d=c.getUint32(e,!g);var r=c.getUint32(e+4,!g);d=g?new t(r,d):new t(d,r);break;case 4:d=c.getUint32(e,!g);break;case 2:d=c.getUint16(e,!g);break;case 1:d=c.getUint8(e);break;case -8:d=c.getFloat64(e,!g);break;case -4:d=c.getFloat32(e,!g);break;case 0:for(h=[];e<c.byteLength&&(0==h.length||0!=h[h.length-1]);++e)h.push(c.getUint8(e));d=String.fromCharCode.apply(null,h);break;default:h=new Uint8Array(c.buffer,c.byteOffset+
e,b),d=h.indexOf(0),0<=d&&(h=h.subarray(0,d)),d=String.fromCharCode.apply(null,h)}e+=Math.abs(b);f[a]=d});return u.reflection.applyConstructor(a,[f])}function P(a){var b=0;a=a.Fields;if(!a)throw new L("Cannot compute size of type (fields not defined)");u.each(a,function(a,d){b+=Math.abs(d)});return b};function Q(){M.apply(this,arguments)}m(Q,M);Object.defineProperties(Q.prototype,{oa:{get:function(){return 2291137574==this.S}},l:{get:function(){return!this.oa}}});Q.Fields={S:4,version:2,L:2,ka:8,Aa:8,Y:8,za:2,xa:2,va:8,Da:8,Ea:4,J:8};function R(){}Object.defineProperties(R.prototype,{chrName:{get:function(){throw new L("Abstract method not implemented");}},chr:{get:function(){throw new L("Abstract method not implemented");}},start:{get:function(){throw new L("Abstract method not implemented");}},end:{get:function(){throw new L("Abstract method not implemented");}}});var S={MIN:0,MAX:1,SUM:2,SUMSQ:3,AVG:4,NORM:5,CNT:6};R.prototype.value=function(){throw new L("Abstract method not implemented");};R.prototype.toString=function(){return JSON.stringify(this.toJSON())};
R.prototype.toJSON=function(){return{chr:this.chrName,start:this.start,end:this.end,value:this.value}};function ta(){M.apply(this,arguments)}m(ta,M);ta.Fields={F:4,start:4,end:4,ea:4,ca:-4,ba:-4,T:-4,U:-4};function ua(a){ba.apply(this,arguments)}m(ua,ba);function va(a,b){var c=[];da(a,function(a){if(b&&(a.I<b.chr||a.K>b.chr)||b&&(a.K==b.chr&&a.m>=b.end||a.I==b.chr&&a.o<=b.start))return!0;if(a.children&&a.children.length)return!1;c.push(a)});return c}function wa(a){ca.apply(this,a);this.v=a.v;this.K=a.K;this.I=a.I;this.m=a.m;this.o=a.o;this.g=a.g;this.H=a.H;this.G=a.G}m(wa,ca);function T(a,b,c){this.ga=a;this.c=b;this.h=c||null}m(T,R);Object.defineProperties(T.prototype,{chrName:{get:function(){return this.h?this.h.P(this.chr).key:this.chr}},chr:{get:function(){return this.c.F}},start:{get:function(){return this.c.start}},end:{get:function(){return this.c.end}}});
T.prototype.value=function(a){switch(a){case S.MIN:return this.c.ca;case S.MAX:return this.c.ba;case S.SUM:return this.c.T;case S.SUMSQ:return this.c.U;case S.NORM:return Math.sqrt(this.c.U/this.c.ea);case S.CNT:return this.c.ea;default:return this.c.T/this.c.ea}};function xa(){M.apply(this,arguments)}m(xa,M);xa.Fields={F:4,start:4,end:4,sa:4,ra:4,type:1,J:1,Z:2};function U(){M.apply(this,arguments)}m(U,M);function V(a,b,c,d,g){this.ga=a;this.W=b;this.c=c;this.ma=d;this.h=g||null}m(V,R);Object.defineProperties(V.prototype,{chrName:{get:function(){return this.h?this.h.P(this.chr).key:this.chr}},chr:{get:function(){return this.W.F}},start:{get:function(){return void 0!=this.c.X?this.c.X:this.ga.m+this.W.sa*this.ma}},end:{get:function(){return void 0!=this.c.ja?this.c.ja:this.start+this.W.ra}}});
V.prototype.value=function(a){switch(a){case S.SUMSQ:return this.c.value*this.c.value;case S.NORM:return Math.abs(this.c.value);case S.CNT:return 1;default:return this.c.value}};var ya=String.prototype.repeat?function(a,b){return a.repeat(b)}:function(a,b){return Array(b+1).join(a)};function za(a,b){var c=Array.prototype.slice.call(arguments),d=c.shift();if("undefined"==typeof d)throw Error("[goog.string.format] Template required");return d.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,d,h,n,k,p,r){if("%"==k)return"%";var y=c.shift();if("undefined"==typeof y)throw Error("[goog.string.format] Not enough arguments");arguments[0]=y;return W[k].apply(null,arguments)})}
var W={s:function(a,b,c){return isNaN(c)||""==c||a.length>=c?a:a=-1<b.indexOf("-",0)?a+ya(" ",c-a.length):ya(" ",c-a.length)+a},f:function(a,b,c,d,g){d=a.toString();isNaN(g)||""==g||(d=parseFloat(a).toFixed(g));var f;f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"";0<=a&&(d=f+d);if(isNaN(c)||d.length>=c)return d;d=isNaN(g)?Math.abs(a).toString():Math.abs(a).toFixed(g);a=c-d.length-f.length;return d=0<=b.indexOf("-",0)?f+d+ya(" ",a):f+ya(0<=b.indexOf("0",0)?"0":" ",a)+d},d:function(a,b,c,d,
g,f,e,h){return W.f(parseInt(a,10),b,c,d,0,f,e,h)}};W.i=W.d;W.u=W.d;function Aa(){M.apply(this,arguments)}m(Aa,M);Aa.Fields={v:1,J:1,count:2};function Ba(){M.apply(this,arguments)}m(Ba,M);function Da(a,b,c){return O(Ba,{key:b,F:4,ia:4},a,c)};function Ea(){M.apply(this,arguments)}m(Ea,M);Ea.Fields={S:4,ha:4,$:4,Fa:4,Z:8,J:8};function Fa(){M.apply(this,arguments)}m(Fa,M);Fa.Fields={S:4,ha:4,Z:8,D:4,m:4,B:4,o:4,ya:8,Ba:4,J:4};function X(){U.apply(this,arguments)}m(X,U);X.Fields={X:4,ja:4,value:-4};function Ga(){M.apply(this,arguments)}m(Ga,M);Ga.Fields={D:4,m:4,B:4,o:4,g:8,H:8};function Ha(a,b){return O(Ga,Ga.Fields,a,b)};function Ia(){M.apply(this,arguments)}m(Ia,M);Ia.Fields={D:4,m:4,B:4,o:4,g:8};function Ja(a,b){return O(Ia,Ia.Fields,a,b)};function Ka(){M.apply(this,arguments)}m(Ka,M);Ka.Fields={ta:4,J:4,g:8,qa:8};function La(){M.apply(this,arguments)}m(La,M);function Ma(a,b,c){return O(La,{key:b,pa:8},a,c)};function Y(){U.apply(this,arguments)}m(Y,U);Y.Fields={X:4,value:-4};function Na(){M.apply(this,arguments)}m(Na,M);Na.Fields={na:8,ca:-8,ba:-8,T:-8,U:-8};function Oa(){M.apply(this,arguments)}m(Oa,M);Oa.Fields={v:1,J:1,count:2};function Z(){U.apply(this,arguments)}m(Z,U);Z.Fields={value:-4};function Pa(a,b,c){this.M=a;this.w=b||null;this.b=null;var d=this;this.aa=new Promise(function(a){void 0!=d.b?a(d.b):d.get(0,1,function(b,c){var h=c.getResponseHeader("Content-Range");d.b=ka(h.substr(h.indexOf("/")+1));a(d.b)})});this.R=c&&0<c?1024*c:Qa;this.a=0===c?this.get:this.N;this.C={}}
var Qa=524288,Ra=P(Q),Sa=P(Ka),Ta=P(Na),Ua=P(Ea),Va=P(Aa),Wa=P(Fa),Xa=P(Oa),Ya=P(Ia),Za=P(Ga),$a=P(xa),ab=P(ta),bb={1:[X,function(a,b){return O(X,X.Fields,a,b)},function(a,b){return N(X,X.Fields,a,b)}],2:[Y,function(a,b){return O(Y,Y.Fields,a,b)},function(a,b){return N(Y,Y.Fields,a,b)}],3:[Z,function(a,b){return O(Z,Z.Fields,a,b)},function(a,b){return N(Z,Z.Fields,a,b)}]};
Pa.prototype.get=function(a,b,c){function d(){var a=new XMLHttpRequest;a.open("GET",n,!0);g.w||a.setRequestHeader("Range",za("bytes=%s-%s",e,h));a.responseType="arraybuffer";a.onload=function(a){c(a.target.response,a.target)};a.onreadystatechange=function(){4===a.readyState&&200!==a.status&&206!=a.status&&(--f,f?(console.log("Failed: Range "+za("bytes=%s-%s",e,h)+"; retrying..."),d()):console.error("Failed: Range "+za("bytes=%s-%s",e,h)))};a.send()}var g=this,f=10,e=a instanceof t?a.toString():a,
h=b instanceof t?K(b,w(1)).toString():b-1,n=this.w?za("%s?r=%s-%s&q=%s",this.w,e,h,this.M):this.M;d()};
Pa.prototype.N=function(a,b,c){var d=this;if(void 0==d.b)d.aa.then(function(){d.N(a,b,c)});else{var g=a instanceof t?a:x(a),f=b instanceof t?b:x(b),e=x(this.R),h=J(g,e),n=J(f,e),k=E(h,e),p=D(k,e);I(h,n)?(e=h.toString(),h=this.C[e],h||(h=new Promise(function(a){0<sa(p,d.b)&&(p=d.b);d.get(k,p,function(b){a(b)})}),this.C[e]=h),h.then(function(a){var b=G(K(g,k)),d=G(K(f,k));c(a.slice(b,d))})):d.get(a,b,c)}};
function cb(a){return new Promise(function(b){a.a(0,Ra,function(a){var d=(new DataView(a)).getUint32(0);a=N(Q,Q.Fields,a,2291137574!=d);a.S=d;b(a)})})}function db(a,b,c){if(c>=b.L||0>c)throw new L("Bigwig: invalid zoom index");return new Promise(function(d){a.a(Ra+c*Sa,Ra+(c+1)*Sa,function(a){a=N(Ka,Ka.Fields,a,b.l);d(a)})})}
function eb(a,b){return new Promise(function(c){var d=Array(b.L);u.async.for(b.L,function(c){return new Promise(function(f){db(a,b,c).then(function(a){d[c]=a;f()})})}).then(function(){c(d)})})}function fb(a,b){return new Promise(function(c){var d=Ra+Sa*b.L;a.a(d,d+Ta,function(a){a=N(Na,Na.Fields,a,b.l);c(a)})})}function gb(a,b){return new Promise(function(c){var d=b.ka;a.a(d,D(d,x(Ua)),function(a){a=N(Ea,Ea.Fields,a,b.l);c(a)})})}
function hb(a,b,c,d){return new Promise(function(g){var f=c.$+8,e=D(d,x(Va+c.ha*f));a.a(d,e,function(a){var d;d=new DataView(a,0,Va);d=O(Aa,Aa.Fields,d,b.l);for(var e=[],p=0;p<d.count;++p)e.push(d.v?Da(new DataView(a,Va+p*f,f),c.$,b.l):Ma(new DataView(a,Va+p*f,f),c.$,b.l));g({node:d,items:e})})})}
function ib(a,b){return new Promise(function(c){var d=null;gb(a,b).then(function(g){function f(c){var d=[];c.items.forEach(function(e){var p=new ea({key:e.key});c.node.v?(p.chrId=e.F,p.chrSize=e.ia):hb(a,b,g,e.pa).then(function(a){p.children=f(a)});d.push(p)});return d}var e=D(b.ka,x(Ua));hb(a,b,g,e).then(function(a){a=f(a);d=new ea({children:a});c(new q(d))})})})}function jb(a,b,c){return new Promise(function(d){c=c||b.Y;a.a(c,D(c,x(Wa)),function(a){a=N(Fa,Fa.Fields,a,b.l);d(a)})})}
function kb(a,b,c){return new Promise(function(d){a.a(c,D(c,x(Xa)),function(a){a=N(Oa,Oa.Fields,a,b.l);d(a)})})}function lb(a,b,c){return new Promise(function(d){kb(a,b,c).then(function(g){var f=D(c,x(Xa)),e=g.v?Za:Ya,h=D(f,x(g.count*e));a.a(f,h,function(a){for(var c=[],f=0;f<g.count;++f)c.push(g.v?Ha(new DataView(a,f*e,e),b.l):Ja(new DataView(a,f*e,e),b.l));d({node:g,items:c})})})})}
function mb(a,b,c){return new Promise(function(d){a.a(c.g,D(c.g,c.H),function(a){a=new Uint8Array(a,0);a=(new Zlib.Inflate(a)).decompress();var c;c=new DataView(a.buffer,0,$a);c=O(xa,xa.Fields,c,b.l);for(var e=[],h=bb[c.type][1],n=P(bb[c.type][0]),k=0;k<c.Z;++k)e[k]=h(new DataView(a.buffer,$a+n*k,n),b.l);d({ua:c,da:e})})})}
function nb(a,b,c){return new Promise(function(d){a.a(c.g,D(c.g,c.H),function(a){a=new Uint8Array(a,0);a=(new Zlib.Inflate(a)).decompress();for(var c=a.byteLength/ab,e=Array(c),h=0;h<c;++h){var n=h,k;k=new DataView(a.buffer,h*ab,ab);k=O(ta,ta.Fields,k,b.l);e[n]=k}d({da:e})})})}
function ob(a,b,c,d){return new Promise(function(g){lb(a,b,d).then(function(d){if(d.node.v){var e=[];d.items.forEach(function(a){e.push(new wa({v:!0,K:a.D,m:a.m,I:a.B,o:a.o,g:a.g,H:a.H}))});g(e)}else{var h=[];u.async.each(d.items,function(d){return new Promise(function(e){var f=new wa({v:!1,K:d.D,m:d.m,I:d.B,o:d.o,g:d.g});h.push(f);c&&d.D>c.chr&&d.B<c.chr?e():c&&(d.B==c.chr&&d.o<=c.start||d.D==c.chr&&d.m>=c.end)?e():ob(a,b,c,d.g).then(function(a){f.children=a;e()})})}).then(function(){g(h)})}})})}
function pb(a,b,c,d){return new Promise(function(g){d=d||b.Y;jb(a,b,d).then(function(f){var e=D(d,x(Wa)),h=new wa({v:!1,K:f.D,I:f.B,m:f.m,o:f.o,g:e});ob(a,b,c,e).then(function(a){h.children=a;g(new ua(h))})})})};function qb(a,b,c){this.a=new Pa(a,b,c);this.C=this.w=this.M=this.h=this.A=this.j=null;this.fa=!1;this.aa=this.R=null;this.N=!1;var d=this;this.V=new Promise(function(a,b){d.R=a;d.aa=b})}
qb.prototype.b=function(a,b){var c=this,d,g=new Promise(function(a){d=a});if(!this.N)return this.initialized.then(function(){c.b(a,b).then(d)}),g;var f;a&&(f=this.h.P(a.chr).chrId,a={chr:f,start:a.start,end:a.end});if(b&&void 0==b.level&&(b.maxItems&&0<b.maxItems||b.maxBases&&0<b.maxBases)){b.maxBases||(b.maxBases=b.maxItems);b.maxItems||(b.maxItems=b.maxBases);f=this.w.map(function(a){return a.ta});var e=-1,h=a?a.end-a.start:this.h.la.map(function(a){return a.chrSize}).reduce(function(a,b){return a+
b});h>b.maxBases&&++e;if(0==e)for(;e<this.w.length-1&&!(h/f[e]<=b.maxItems);++e);b.level=e}var n=b&&0<=b.level;f=n?this.C[b.level]:this.M;if(!f)return pb(this.a,this.j,a,n?this.w[b.level].qa:this.j.Y).then(function(e){n?c.C[b.level]=e:c.M=e;c.b(a,b).then(d)}),g;f=va(f,a);var k=0;f.forEach(function(e){e.v||(++k,ob(c.a,c.j,a,e.g).then(function(f){e.children=f;--k;k||c.b(a,b).then(d)}))});if(k)return g;k=0;f.forEach(function(e){e.G||(++k,n?nb(c.a,c.j,e).then(function(f){e.G=f.da.map(function(a){return new T(e,
a,c.h)});--k;k||c.b(a,b).then(d)}):mb(c.a,c.j,e).then(function(f){e.G=f.da.map(function(a,b){return new V(e,f.ua,a,b,c.h)});--k;k||c.b(a,b).then(d)}))});if(k)return g;f=f.map(function(b){return a?b.G.filter(function(b){return b.chr==a.chr&&b.start<a.end&&b.end>a.start}):b.G}).reduce(function(a,b){return a.concat(b)});d(f);return g};
Object.defineProperties(qb.prototype,{initialized:{get:function(){if(this.fa)return this.V;this.fa=!0;rb(this);return this.V}},summary:{get:function(){return this.A?{basesCovered:this.A.na.toString(),min:this.A.ca,max:this.A.ba,sumData:this.A.T,sumSquares:this.A.U}:null}},chromosomes:{get:function(){return this.h?this.h.la:null}},zoomLevels:{get:function(){return this.j?this.j.L:null}}});
function rb(a){var b,c=new Promise(function(a){b=a});if(!a.j)return cb(a.a).then(function(c){a.j=c;rb(a).then(b)}),c;if(!a.A)return fb(a.a,a.j).then(function(c){a.A=c;rb(a).then(b)}),c;if(!a.h)return ib(a.a,a.j).then(function(c){a.h=c;rb(a).then(b)}),c;if(!a.w)return eb(a.a,a.j).then(function(c){a.w=c;rb(a).then(b)}),c;a.C||(a.C=Array(a.j.L));a.N=!0;a.R(a);return a.V};l("bigwig.BigwigFile",qb);qb.prototype.query=qb.prototype.b;l("bigwig.ChrTree",q);q.prototype.getLeaf=q.prototype.P;l("bigwig.ChrTree.Node",ea);V.prototype.value=V.prototype.value;T.prototype.value=T.prototype.value;l("bigwig.DataRecord",R);R.prototype.value=R.prototype.value;l("bigwig.DataRecord.Aggregate",S);}).call(this); //@ sourceMappingURL=bigwig.min.js.map
