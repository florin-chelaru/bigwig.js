/**
* @license bigwig.js
* Copyright (c) 2015 Florin Chelaru
* License: MIT
*
* Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
* documentation files (the "Software"), to deal in the Software without restriction, including without limitation the
* rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to
* permit persons to whom the Software is furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the
* Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
* WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
* COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
* OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
(function(){'use strict';var k=this;function aa(){}
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function m(a){return"function"==ba(a)}function ca(a,b,c){return a.call.apply(a.bind,arguments)}function da(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function r(a,b,c){r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:da;return r.apply(null,arguments)}function ea(a,b){var c=a.split("."),d=k;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}
function t(a,b){function c(){}c.prototype=b.prototype;a.Ia=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Aa=function(a,c,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}};function v(a){if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}t(v,Error);v.prototype.name="CustomError";var fa=String.prototype.repeat?function(a,b){return a.repeat(b)}:function(a,b){return Array(b+1).join(a)};function ga(a,b,c){this.g=c;this.c=a;this.h=b;this.b=0;this.a=null}ga.prototype.get=function(){var a;0<this.b?(this.b--,a=this.a,this.a=a.next,a.next=null):a=this.c();return a};function ha(a,b){a.h(b);a.b<a.g&&(a.b++,b.next=a.a,a.a=b)};var w;a:{var ia=k.navigator;if(ia){var ja=ia.userAgent;if(ja){w=ja;break a}}w=""};var ka=Array.prototype,la=ka.some?function(a,b,c){return ka.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e="string"==typeof a?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function ma(a){k.setTimeout(function(){throw a;},0)}var na;
function oa(){var a=k.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&-1==w.indexOf("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow,a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host,a=r(function(a){if(("*"==d||a.origin==
d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&-1==w.indexOf("Trident")&&-1==w.indexOf("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.ca;c.ca=null;a()}};return function(a){d.next={ca:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=
document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){k.setTimeout(a,0)}};function pa(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function qa(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}};function ra(){this.b=this.a=null}var ta=new ga(function(){return new sa},function(a){a.reset()},100);ra.prototype.add=function(a,b){var c=ta.get();c.a=a;c.b=b;c.next=null;this.b?this.b.next=c:this.a=c;this.b=c};function ua(){var a=va,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function sa(){this.next=this.b=this.a=null}sa.prototype.reset=function(){this.next=this.b=this.a=null};function wa(a,b){xa||ya();za||(xa(),za=!0);va.add(a,b)}var xa;function ya(){if(k.Promise&&k.Promise.resolve){var a=k.Promise.resolve(void 0);xa=function(){a.then(Aa)}}else xa=function(){var a=Aa;!m(k.setImmediate)||k.Window&&k.Window.prototype&&k.Window.prototype.setImmediate==k.setImmediate?(na||(na=oa()),na(a)):k.setImmediate(a)}}var za=!1,va=new ra;function Aa(){for(var a=null;a=ua();){try{a.a.call(a.b)}catch(b){ma(b)}ha(ta,a)}za=!1};function x(a,b){this.a=Ba;this.G=void 0;this.c=this.b=this.g=null;this.h=this.C=!1;if(a!=aa)try{var c=this;a.call(b,function(a){y(c,Ca,a)},function(a){y(c,A,a)})}catch(d){y(this,A,d)}}var Ba=0,Ca=2,A=3;function Da(){this.next=this.c=this.b=this.g=this.a=null;this.h=!1}Da.prototype.reset=function(){this.c=this.b=this.g=this.a=null;this.h=!1};var Ea=new ga(function(){return new Da},function(a){a.reset()},100);function Fa(a,b,c){var d=Ea.get();d.g=a;d.b=b;d.c=c;return d}
x.prototype.then=function(a,b,c){return Ga(this,m(a)?a:null,m(b)?b:null,c)};pa(x);function Ha(a,b){a.b||a.a!=Ca&&a.a!=A||Ia(a);a.c?a.c.next=b:a.b=b;a.c=b}function Ga(a,b,c,d){var e=Fa(null,null,null);e.a=new x(function(a,g){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(p){g(p)}}:a;e.b=c?function(b){try{var e=c.call(d,b);a(e)}catch(p){g(p)}}:g});e.a.g=a;Ha(a,e);return e.a}x.prototype.U=function(a){this.a=Ba;y(this,Ca,a)};x.prototype.$=function(a){this.a=Ba;y(this,A,a)};
function y(a,b,c){if(a.a==Ba){a==c&&(b=A,c=new TypeError("Promise cannot resolve to itself"));a.a=1;var d;a:{var e=c,f=a.U,g=a.$;if(e instanceof x)Ha(e,Fa(f||aa,g||null,a)),d=!0;else if(qa(e))e.then(f,g,a),d=!0;else{var h=typeof e;if("object"==h&&null!=e||"function"==h)try{var n=e.then;if(m(n)){Ja(e,n,f,g,a);d=!0;break a}}catch(p){g.call(a,p);d=!0;break a}d=!1}}d||(a.G=c,a.a=b,a.g=null,Ia(a),b!=A||Ka(a,c))}}
function Ja(a,b,c,d,e){function f(a){h||(h=!0,d.call(e,a))}function g(a){h||(h=!0,c.call(e,a))}var h=!1;try{b.call(a,g,f)}catch(n){f(n)}}function Ia(a){a.C||(a.C=!0,wa(a.S,a))}function La(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.c=null);return b}
x.prototype.S=function(){for(var a=null;a=La(this);){var b=this.a,c=this.G;if(b==A&&a.b&&!a.h)for(var d=void 0,d=this;d&&d.h;d=d.g)d.h=!1;if(a.a)a.a.g=null,Ma(a,b,c);else try{a.h?a.g.call(a.c):Ma(a,b,c)}catch(e){Oa.call(null,e)}ha(Ea,a)}this.C=!1};function Ma(a,b,c){b==Ca?a.g.call(a.c,c):a.b&&a.b.call(a.c,c)}function Ka(a,b){a.h=!0;wa(function(){a.h&&Oa.call(null,b)})}var Oa=ma;/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function B(a,b){this.g=[];this.ha=b||null;this.b=this.L=!1;this.c=void 0;this.U=this.$=this.C=!1;this.h=0;this.G=null;this.xa=0}B.prototype.S=function(a,b){this.C=!1;Pa(this,a,b)};function Pa(a,b,c){a.L=!0;a.c=c;a.b=!b;Qa(a)}function Ra(a){if(a.L){if(!a.U)throw new Sa;a.U=!1}}B.prototype.a=function(a){Ra(this);Pa(this,!0,a)};B.prototype.ia=function(a){Ra(this);Pa(this,!1,a)};function Ta(a,b,c,d){a.g.push([b,c,d]);a.L&&Qa(a)}
B.prototype.then=function(a,b,c){var d,e,f=new x(function(a,b){d=a;e=b});Ta(this,d,function(a){e(a)});return f.then(a,b,c)};pa(B);function C(a,b){Ta(a,b.a,b.ia,b)}function Ua(a){return la(a.g,function(a){return m(a[1])})}
function Qa(a){if(a.h&&a.L&&Ua(a)){var b=a.h,c=Va[b];c&&(k.clearTimeout(c.R),delete Va[b]);a.h=0}a.G&&(a.G.xa--,delete a.G);for(var b=a.c,d=c=!1;a.g.length&&!a.C;){var e=a.g.shift(),f=e[0],g=e[1],e=e[2];if(f=a.b?g:f)try{var h=f.call(e||a.ha,b);void 0!==h&&(a.b=a.b&&(h==b||h instanceof Error),a.c=b=h);if(qa(b)||"function"===typeof k.Promise&&b instanceof k.Promise)d=!0,a.C=!0}catch(n){b=n,a.b=!0,Ua(a)||(c=!0)}}a.c=b;d&&(h=r(a.S,a,!0),d=r(a.S,a,!1),b instanceof B?(Ta(b,h,d),b.$=!0):b.then(h,d));c&&
(b=new Wa(b),Va[b.R]=b,a.h=b.R)}function Sa(){v.call(this)}t(Sa,v);Sa.prototype.message="Deferred has already fired";Sa.prototype.name="AlreadyCalledError";function Wa(a){this.R=k.setTimeout(r(this.b,this),0);this.a=a}Wa.prototype.b=function(){delete Va[this.R];throw this.a;};var Va={};function Xa(a,b){u.Exception.apply(this,arguments);this.name="BigwigException"}t(Xa,u.Exception);function D(a,b){this.b=a|0;this.a=b|0}var Ya={},E={};function Za(a){if(-128<=a&&128>a){var b=Ya[a];if(b)return b}b=new D(a|0,0>a?-1:0);-128<=a&&128>a&&(Ya[a]=b);return b}function F(a){isNaN(a)||!isFinite(a)?a=G():a<=-$a?a=H():a+1>=$a?(E[ab]||(E[ab]=new D(-1,2147483647)),a=E[ab]):a=0>a?I(F(-a)):new D(a%J|0,a/J|0);return a}var J=4294967296,$a=J*J/2;function G(){E[bb]||(E[bb]=Za(0));return E[bb]}function cb(){E[db]||(E[db]=Za(1));return E[db]}function eb(){E[fb]||(E[fb]=Za(-1));return E[fb]}
function H(){E[gb]||(E[gb]=new D(0,-2147483648));return E[gb]}D.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(K(this))return"0";if(0>this.a){if(L(this,H())){var b=F(a),c=M(this,b),b=N(O(c,b),this);return c.toString(a)+b.b.toString(a)}return"-"+I(this).toString(a)}for(var c=F(Math.pow(a,6)),b=this,d="";;){var e=M(b,c),f=(N(b,O(e,c)).b>>>0).toString(a),b=e;if(K(b))return f+d;for(;6>f.length;)f="0"+f;d=""+f+d}};function hb(a){return 0<=a.b?a.b:J+a.b}
function K(a){return 0==a.a&&0==a.b}function L(a,b){return a.a==b.a&&a.b==b.b}function ib(a){E[jb]||(E[jb]=Za(16777216));return 0>kb(a,E[jb])}function kb(a,b){if(L(a,b))return 0;var c=0>a.a,d=0>b.a;return c&&!d?-1:!c&&d?1:0>N(a,b).a?-1:1}function I(a){return L(a,H())?H():(new D(~a.b,~a.a)).add(cb())}
D.prototype.add=function(a){var b=this.a>>>16,c=this.a&65535,d=this.b>>>16,e=a.a>>>16,f=a.a&65535,g=a.b>>>16,h;h=0+((this.b&65535)+(a.b&65535));a=0+(h>>>16);a+=d+g;d=0+(a>>>16);d+=c+f;c=0+(d>>>16);c=c+(b+e)&65535;return new D((a&65535)<<16|h&65535,c<<16|d&65535)};function N(a,b){return a.add(I(b))}
function O(a,b){if(K(a)||K(b))return G();if(L(a,H()))return 1==(b.b&1)?H():G();if(L(b,H()))return 1==(a.b&1)?H():G();if(0>a.a)return 0>b.a?O(I(a),I(b)):I(O(I(a),b));if(0>b.a)return I(O(a,I(b)));if(ib(a)&&ib(b))return F((a.a*J+hb(a))*(b.a*J+hb(b)));var c=a.a>>>16,d=a.a&65535,e=a.b>>>16,f=a.b&65535,g=b.a>>>16,h=b.a&65535,n=b.b>>>16,p=b.b&65535,l,q,z,Na;Na=0+f*p;z=0+(Na>>>16);z+=e*p;q=0+(z>>>16);z=(z&65535)+f*n;q+=z>>>16;z&=65535;q+=d*p;l=0+(q>>>16);q=(q&65535)+e*n;l+=q>>>16;q&=65535;q+=f*h;l+=q>>>16;
q&=65535;l=l+(c*p+d*n+e*h+f*g)&65535;return new D(z<<16|Na&65535,l<<16|q)}
function M(a,b){if(K(b))throw Error("division by zero");if(K(a))return G();if(L(a,H())){if(L(b,cb())||L(b,eb()))return H();if(L(b,H()))return cb();var c;c=1;if(0==c)c=a;else{var d=a.a;c=32>c?new D(a.b>>>c|d<<32-c,d>>c):new D(d>>c-32,0<=d?0:-1)}c=M(c,b);d=1;if(0!=d){var e=c.b;c=32>d?new D(e<<d,c.a<<d|e>>>32-d):new D(0,e<<d-32)}if(L(c,G()))return 0>b.a?cb():eb();d=N(a,O(b,c));return c.add(M(d,b))}if(L(b,H()))return G();if(0>a.a)return 0>b.a?M(I(a),I(b)):I(M(I(a),b));if(0>b.a)return I(M(a,I(b)));e=G();
for(d=a;0<=kb(d,b);){c=Math.max(1,Math.floor((d.a*J+hb(d))/(b.a*J+hb(b))));for(var f=Math.ceil(Math.log(c)/Math.LN2),f=48>=f?1:Math.pow(2,f-48),g=F(c),h=O(g,b);0>h.a||0<kb(h,d);)c-=f,g=F(c),h=O(g,b);K(g)&&(g=cb());e=e.add(g);d=N(d,h)}return e}var ab=1,gb=2,bb=3,db=4,fb=5,jb=6;function P(a){var b=this;u.each(a,function(a,d){b[a]=d})}P.prototype.toString=function(){return JSON.stringify(this,function(a,b){return b instanceof D?0==b.a?hb(b):b.toString():b})};function Q(a,b,c,d){c=new DataView(c);return R(a,b,c,d)}
function R(a,b,c,d){var e=!d,f={},g=0,h;u.each(b,function(a,b){var d;switch(b){case 8:d=c.getUint32(g,!e);var q=c.getUint32(g+4,!e);d=e?new D(q,d):new D(d,q);break;case 4:d=c.getUint32(g,!e);break;case 2:d=c.getUint16(g,!e);break;case 1:d=c.getUint8(g);break;case -8:d=c.getFloat64(g,!e);break;case -4:d=c.getFloat32(g,!e);break;case 0:for(h=[];g<c.byteLength&&(0==h.length||0!=h[h.length-1]);++g)h.push(c.getUint8(g));d=String.fromCharCode.apply(null,h);break;default:h=new Uint8Array(c.buffer,c.byteOffset+
g,b),d=h.indexOf(0),0<=d&&(h=h.subarray(0,d)),d=String.fromCharCode.apply(null,h)}g+=Math.abs(b);f[a]=d});return u.reflection.applyConstructor(a,[f])}function S(a){var b=0;a=a.Fields;if(!a)throw new Xa("Cannot compute size of type (fields not defined)");u.each(a,function(a,d){b+=Math.abs(d)});return b};function T(){P.apply(this,arguments)}t(T,P);Object.defineProperties(T.prototype,{ma:{get:function(){return 2291137574==this.T}},v:{get:function(){return!this.ma}}});T.Fields={T:4,version:2,ya:2,fa:8,Ea:8,ga:8,Da:2,Ba:2,za:8,Ja:8,Ka:4,H:8};function lb(a){this.b=a}function mb(a){this.children=a?a.children||null:null}function nb(a,b){if(a.b){var c=function(a){b.call(null,a)||a.children&&a.children.length&&a.children.forEach(c)};c(a.b)}};function U(a){lb.apply(this,arguments);this.N=this.a=null}t(U,lb);function ob(a){mb.apply(this,arguments);this.key=a.key;this.chrId=a.O;this.chrSize=a.da}t(ob,mb);U.prototype.X=function(a){if("number"==typeof a)return pb(this),this.a[a];qb(this);return this.N[a]};Object.defineProperties(U.prototype,{qa:{get:function(){qb(this);return u.map(this.N,function(a){return a})}}});function qb(a){if(!a.N){var b={};nb(a,function(a){a.children||(b[a.key]=a)});a.N=b}}
function pb(a){if(!a.a){var b={};nb(a,function(a){a.children||(b[a.chrId]=a)});a.a=b}};function rb(){P.apply(this,arguments)}t(rb,P);rb.Fields={O:4,start:4,end:4,pa:4,oa:4,type:1,H:1,Y:2};function V(){P.apply(this,arguments)}t(V,P);function sb(a){lb.apply(this,arguments)}t(sb,lb);function tb(a,b,c,d){var e=[];nb(a,function(a){if(a.F<b||a.I>b||a.I==b&&a.l>=d||a.F==b&&a.m<=c)return!0;if(a.children&&a.children.length)return!1;e.push(a)});return e}function ub(a){mb.apply(this,a);this.o=a.o;this.I=a.I;this.F=a.F;this.l=a.l;this.m=a.m;this.j=a.j;this.K=a.K;this.P=a.P}t(ub,mb);function vb(a,b,c,d,e){this.ka=a;this.V=b;this.J=c;this.ja=d;this.w=e||null}Object.defineProperties(vb.prototype,{chrName:{get:function(){return this.w?this.w.X(this.chr).key:this.chr}},chr:{get:function(){return this.V.O}},start:{get:function(){return void 0!=this.J.W?this.J.W:this.ka.l+this.V.pa*this.ja}},end:{get:function(){return void 0!=this.J.ea?this.J.ea:this.start+this.V.oa}},value:{get:function(){return this.J.value}}});vb.prototype.toString=function(){return JSON.stringify(this.toJSON())};
vb.prototype.toJSON=function(){return{chr:this.chrName,start:this.start,end:this.end,value:this.value}};function wb(){P.apply(this,arguments)}t(wb,P);wb.Fields={la:8,sa:-8,ra:-8,va:-8,wa:-8};function xb(){P.apply(this,arguments)}t(xb,P);xb.Fields={D:4,l:4,B:4,m:4,j:8};function yb(a,b){return R(xb,xb.Fields,a,b)};function zb(){P.apply(this,arguments)}t(zb,P);zb.Fields={T:4,ba:4,Z:4,La:4,Y:8,H:8};function Ab(){P.apply(this,arguments)}t(Ab,P);function Bb(a,b,c){return R(Ab,{key:b,O:4,da:4},a,c)};function Cb(){P.apply(this,arguments)}t(Cb,P);Cb.Fields={o:1,H:1,count:2};function Db(){P.apply(this,arguments)}t(Db,P);Db.Fields={Ha:4,H:4,j:8,Fa:8};function Eb(){P.apply(this,arguments)}t(Eb,P);Eb.Fields={o:1,H:1,count:2};function Fb(){P.apply(this,arguments)}t(Fb,P);Fb.Fields={T:4,ba:4,Y:8,D:4,l:4,B:4,m:4,Ca:8,Ga:4,H:4};function Gb(){P.apply(this,arguments)}t(Gb,P);Gb.Fields={D:4,l:4,B:4,m:4,j:8,K:8};function Hb(a,b){return R(Gb,Gb.Fields,a,b)};function W(){V.apply(this,arguments)}t(W,V);W.Fields={value:-4};function X(){V.apply(this,arguments)}t(X,V);X.Fields={W:4,value:-4};function Ib(){P.apply(this,arguments)}t(Ib,P);function Jb(a,b,c){return R(Ib,{key:b,na:8},a,c)};function Kb(a,b){var c=Array.prototype.slice.call(arguments),d=c.shift();if("undefined"==typeof d)throw Error("[goog.string.format] Template required");return d.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(a,b,d,h,n,p,l,q){if("%"==p)return"%";var z=c.shift();if("undefined"==typeof z)throw Error("[goog.string.format] Not enough arguments");arguments[0]=z;return Y[p].apply(null,arguments)})}
var Y={s:function(a,b,c){return isNaN(c)||""==c||a.length>=c?a:a=-1<b.indexOf("-",0)?a+fa(" ",c-a.length):fa(" ",c-a.length)+a},f:function(a,b,c,d,e){d=a.toString();isNaN(e)||""==e||(d=parseFloat(a).toFixed(e));var f;f=0>a?"-":0<=b.indexOf("+")?"+":0<=b.indexOf(" ")?" ":"";0<=a&&(d=f+d);if(isNaN(c)||d.length>=c)return d;d=isNaN(e)?Math.abs(a).toString():Math.abs(a).toFixed(e);a=c-d.length-f.length;return d=0<=b.indexOf("-",0)?f+d+fa(" ",a):f+fa(0<=b.indexOf("0",0)?"0":" ",a)+d},d:function(a,b,c,d,
e,f,g,h){return Y.f(parseInt(a,10),b,c,d,0,f,g,h)}};Y.i=Y.d;Y.u=Y.d;function Z(){V.apply(this,arguments)}t(Z,V);Z.Fields={W:4,ea:4,value:-4};function Lb(a,b){this.b=a;this.a=b||null}var Mb=S(T),Nb=S(Db),Ob=S(wb),Pb=S(zb),Qb=S(Cb),Rb=S(Fb),Sb=S(Eb),Tb=S(xb),Ub=S(Gb),Vb=S(rb),Wb={1:[Z,function(a,b){return R(Z,Z.Fields,a,b)},function(a,b){return Q(Z,Z.Fields,a,b)}],2:[X,function(a,b){return R(X,X.Fields,a,b)},function(a,b){return Q(X,X.Fields,a,b)}],3:[W,function(a,b){return R(W,W.Fields,a,b)},function(a,b){return Q(W,W.Fields,a,b)}]};
Lb.prototype.get=function(a,b,c){function d(){var a=new XMLHttpRequest;a.open("GET",n,!0);e.a||a.setRequestHeader("Range",Kb("bytes=%s-%s",g,h));a.responseType="arraybuffer";a.onload=c;a.onreadystatechange=function(){4===a.readyState&&200!==a.status&&206!=a.status&&(--f,f?(console.log("Failed: Range "+Kb("bytes=%s-%s",g,h)+"; retrying..."),d()):console.error("Failed: Range "+Kb("bytes=%s-%s",g,h)))};a.send()}var e=this,f=10,g=a instanceof D?a.toString():a,h=b instanceof D?N(b,Za(1)).toString():b-
1,n=this.a?Kb("%s?r=%s-%s&q=%s",this.a,g,h,this.b):this.b;d()};function Xb(a){var b=new B;a.get(0,Mb,function(a){var d=a.target.response;a=(new DataView(d)).getUint32(0);d=Q(T,T.Fields,d,2291137574!=a);d.T=a;b.a(d)});return b}function Yb(a,b){var c=new B,d=Mb+Nb*b.ya;a.get(d,d+Ob,function(a){a=Q(wb,wb.Fields,a.target.response,b.v);c.a(a)});return c}function Zb(a,b){var c=new B,d=b.fa;a.get(d,d.add(F(Pb)),function(a){a=Q(zb,zb.Fields,a.target.response,b.v);c.a(a)});return c}
function $b(a,b,c,d){var e=new B,f=c.Z+8,g=d.add(F(Qb+c.ba*f));a.get(d,g,function(a){a=a.target.response;var d;d=new DataView(a,0,Qb);d=R(Cb,Cb.Fields,d,b.v);for(var g=[],l=0;l<d.count;++l)g.push(d.o?Bb(new DataView(a,Qb+l*f,f),c.Z,b.v):Jb(new DataView(a,Qb+l*f,f),c.Z,b.v));e.a({node:d,items:g})});return e}
function ac(a,b){var c=null,d=new B;Zb(a,b).then(function(e){function f(c){var d=[];c.items.forEach(function(g){var l=new ob({key:g.key});c.node.o?(l.chrId=g.O,l.chrSize=g.da):$b(a,b,e,g.na).then(function(a){l.children=f(a)});d.push(l)});return d}var g=b.fa.add(F(Pb));$b(a,b,e,g).then(function(a){a=f(a);c=new ob({children:a});d.a(new U(c))})});return d}function bc(a,b){var c=new B,d=b.ga;a.get(d,d.add(F(Rb)),function(a){a=Q(Fb,Fb.Fields,a.target.response,b.v);c.a(a)});return c}
function cc(a,b,c){var d=new B;a.get(c,c.add(F(Sb)),function(a){a=Q(Eb,Eb.Fields,a.target.response,b.v);d.a(a)});return d}function dc(a,b,c){var d=new B;cc(a,b,c).then(function(e){var f=c.add(F(Sb)),g=e.o?Ub:Tb,h=f.add(F(e.count*g));a.get(f,h,function(a){a=a.target.response;for(var c=[],f=0;f<e.count;++f)c.push(e.o?Hb(new DataView(a,f*g,g),b.v):yb(new DataView(a,f*g,g),b.v));d.a({node:e,items:c})})});return d}
function ec(a,b,c){var d=new B;a.get(c.j,c.j.add(c.K),function(a){a=new Uint8Array(a.target.response);a=(new Zlib.Inflate(a)).decompress();var c;c=new DataView(a.buffer,0,Vb);c=R(rb,rb.Fields,c,b.v);for(var g=[],h=Wb[c.type][1],n=S(Wb[c.type][0]),p=0;p<c.Y;++p)g[p]=h(new DataView(a.buffer,Vb+n*p,n),b.v);d.a({ua:c,ta:g})});return d}
function fc(a,b,c,d,e,f){var g=new B;dc(a,b,f).then(function(f){if(f.node.o){var n=[];f.items.forEach(function(a){n.push(new ub({o:!0,I:a.D,l:a.l,F:a.B,m:a.m,j:a.j,K:a.K}))});g.a(n)}else{var p=[],l=f.items.length;f.items.forEach(function(f){var h=new ub({o:!1,I:f.D,l:f.l,F:f.B,m:f.m,j:f.j});p.push(h);f.D>c&&f.B<c?--l:f.B==c&&f.m<=d||f.D==c&&f.l>=e?--l:fc(a,b,c,d,e,f.j).then(function(a){h.children=a;--l;l||g.a(p)})});l||g.a(p)}});return g}
function gc(a,b,c,d,e){var f=new B;bc(a,b).then(function(g){var h=b.ga.add(F(Rb)),n=new ub({o:!1,I:g.D,F:g.B,l:g.l,m:g.m,j:h});fc(a,b,c,d,e,h).then(function(a){n.children=a;f.a(new sb(n))})});return f};function hc(a,b){this.b=new Lb(a,b);this.g=this.w=this.A=this.a=null;this.aa=!1;this.M=new B}
hc.prototype.c=function(a,b,c){var d=this,e=new B;if(!this.initialized.L)return this.initialized.then(function(){C(d.c(a,b,c),e)}),e;var f=this.w.X(a).chrId;if(!this.g)return gc(this.b,this.a,f,b,c).then(function(a){d.g=a;C(d.c(f,b,c),e)}),e;var g=tb(this.g,f,b,c),h=0;g.forEach(function(a){a.o||(++h,fc(d.b,d.a,f,b,c,a.j).then(function(g){a.children=g;--h;h||C(d.c(f,b,c),e)}))});if(h)return e;h=0;g.forEach(function(a){a.P||(++h,ec(d.b,d.a,a).then(function(g){a.P=g.ta.map(function(b,c){return new vb(a,
g.ua,b,c,d.w)});--h;h||C(d.c(f,b,c),e)}))});if(h)return e;g=g.map(function(a){return a.P.filter(function(a){return a.chr==f&&a.start<c&&a.end>b})}).reduce(function(a,b){return a.concat(b)});e.a(g);return e};
Object.defineProperties(hc.prototype,{initialized:{get:function(){if(this.aa)return this.M;this.aa=!0;ic(this);return this.M}},summary:{get:function(){return this.A?{basesCovered:this.A.la.toString(),min:this.A.sa,max:this.A.ra,sumData:this.A.va,sumSquares:this.A.wa}:null}},chromosomes:{get:function(){return this.w?this.w.qa:null}}});
function ic(a){var b=new B;if(!a.a)return Xb(a.b).then(function(c){a.a=c;C(ic(a),b)}),b;if(!a.A)return Yb(a.b,a.a).then(function(c){a.A=c;C(ic(a),b)}),b;if(!a.w)return ac(a.b,a.a).then(function(c){a.w=c;C(ic(a),b)}),b;a.M.a(a);return a.M};ea("bigwig.BigwigFile",hc);hc.prototype.query=hc.prototype.c;ea("bigwig.ChrTree",U);U.prototype.getLeaf=U.prototype.X;ea("bigwig.ChrTree.Node",ob);ea("bigwig.DataRecord",vb);}).call(this); //@ sourceMappingURL=bigwig.min.js.map
